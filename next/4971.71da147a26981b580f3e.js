/*! For license information please see 4971.71da147a26981b580f3e.js.LICENSE.txt */
(self.webpackChunk_player_ui_docs=self.webpackChunk_player_ui_docs||[]).push([[4971],{45907:function(e){e.exports=function(e,t,r,n,o){for(t=t.split?t.split("."):t,n=0;n<t.length;n++)e=e?e[t[n]]:o;return e===o?r:e}},43762:e=>{"use strict";e.exports=()=>{const e={};return e.promise=new Promise(((t,r)=>{e.resolve=t,e.reject=r})),e}},91189:(e,t,r)=>{let n;e.exports="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:r.g):e=>(n||(n=Promise.resolve())).then(e).catch((e=>setTimeout((()=>{throw e}),0)))},38811:function(e,t,r){!function(e,t){"use strict";function r(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(r){if("default"!==r){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}})),t.default=e,Object.freeze(t)}var n=r(t);function o(e,t){return o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},o(e,t)}function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,o(e,t)}var i=function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),e.length!==t.length||e.some((function(e,r){return!Object.is(e,t[r])}))},a={error:null},l=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).state=a,t.resetErrorBoundary=function(){for(var e,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];null==t.props.onReset||(e=t.props).onReset.apply(e,n),t.reset()},t}s(t,e),t.getDerivedStateFromError=function(e){return{error:e}};var r=t.prototype;return r.reset=function(){this.setState(a)},r.componentDidCatch=function(e,t){var r,n;null==(r=(n=this.props).onError)||r.call(n,e,t)},r.componentDidUpdate=function(e,t){var r,n,o=this.state.error,s=this.props.resetKeys;null!==o&&null!==t.error&&i(e.resetKeys,s)&&(null==(r=(n=this.props).onResetKeysChange)||r.call(n,e.resetKeys,s),this.reset())},r.render=function(){var e=this.state.error,t=this.props,r=t.fallbackRender,o=t.FallbackComponent,s=t.fallback;if(null!==e){var i={error:e,resetErrorBoundary:this.resetErrorBoundary};if(n.isValidElement(s))return s;if("function"==typeof r)return r(i);if(o)return n.createElement(o,i);throw new Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},t}(n.Component);function c(e,t){var r=function(r){return n.createElement(l,t,n.createElement(e,r))},o=e.displayName||e.name||"Unknown";return r.displayName="withErrorBoundary("+o+")",r}function d(e){var t=n.useState(null),r=t[0],o=t[1];if(null!=e)throw e;if(null!=r)throw r;return o}e.ErrorBoundary=l,e.useErrorHandler=d,e.withErrorBoundary=c,Object.defineProperty(e,"__esModule",{value:!0})}(t,r(52112))},30160:(e,t,r)=>{var n,o=function(){var e,t,r=((t=(e={constructor:function(e,t){this.array=[],this.compare=t||n;for(var r=e.length,o=0;o<r;)this.insert(e[o++])},insert:function(e){for(var t,r,n=this.array,o=this.compare,s=n.length-1,i=0,a=-1;s>=i;)if((r=o(n[t=(s+i)/2>>>0],e))<0)i=t+1;else{if(!(r>0)){a=t;break}s=t-1}for(-1===a&&(a=s),a++,s=n.length-1;a<s&&0===o(e,n[a]);)a++;for(t=n.length,n.push(e);t>a;)n[t]=n[--t];return n[a]=e,this},search:function(e){for(var t,r,n=this.array,o=this.compare,s=n.length-1,i=0;s>=i;)if((r=o(n[t=(s+i)/2>>>0],e))<0)i=t+1;else{if(!(r>0))return t;s=t-1}return-1},remove:function(e){var t=this.search(e);return t>=0&&this.array.splice(t,1),this}}).constructor).prototype=e,t);return r.comparing=function(e,t){return new r(t,(function(t,r){return n(t[e],r[e])}))},r;function n(e,t){return e<t?-1:e>t?1:0}}();e.exports=o,void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n)},26345:(e,t)=>{"use strict";t.o8=a,t.sh=c,t.Wq=f,t.hZ=v,t.Oe=y,t.cJ=C;const r="INVALID_ARGS",n=!1;function o(e){throw new Error(e)}function s(e){const t=Object.keys(e);return Object.getOwnPropertySymbols?t.concat(Object.getOwnPropertySymbols(e)):t}const i={}.hasOwnProperty;function a(e){if(Array.isArray(e))return e.slice();const t=e,r=s(t),n={};for(let e=0;e<r.length;e++){const o=r[e];n[o]=t[o]}return n}function l(e){return null!=e&&"object"==typeof e}function c(e,t){return Array.isArray(t)?e.concat(t):e.concat([t])}function d(e,t){return Array.isArray(t)?t.concat(e):[t].concat(e)}function u(e){return e.length?e.slice(0,e.length-1):e}function h(e){return e.length?e.slice(1):e}function p(e,t,r){return e.slice(0,t).concat(Array.isArray(r)?r:[r]).concat(e.slice(t))}function f(e,t){return t>=e.length||t<0?e:e.slice(0,t).concat(e.slice(t+1))}function g(e,t,r){if(e[t]===r)return e;const n=e.length,o=Array(n);for(let t=0;t<n;t++)o[t]=e[t];return o[t]=r,o}function m(e,t){if(Array.isArray(t)||o(n?"A path array should be provided when calling getIn()":r),null==e)return;let s=e;for(let e=0;e<t.length;e++){const r=t[e];if(s=null!=s?s[r]:void 0,void 0===s)return s}return s}function v(e,t,r){let n=e;if(null==n&&(n="number"==typeof t?[]:{}),n[t]===r)return n;const o=a(n);return o[t]=r,o}function y(e,t,r){return t.length?w(e,t,r,0):r}function w(e,t,r,n){let o;const s=t[n];if(n===t.length-1)o=r;else{o=w(l(e)&&l(e[s])?e[s]:"number"==typeof t[n+1]?[]:{},t,r,n+1)}return v(e,s,o)}function b(e,t,r){return v(e,t,r(null==e?void 0:e[t]))}function k(e,t,r){return y(e,t,r(m(e,t)))}function x(e,t,r,n,o,s,...i){return i.length?j.call(null,!1,!1,e,t,r,n,o,s,...i):j(!1,!1,e,t,r,n,o,s)}function E(e,t,r,n,o,s,...i){return i.length?j.call(null,!1,!0,e,t,r,n,o,s,...i):j(!1,!0,e,t,r,n,o,s)}function S(e,t,r,n,o,s,i,...a){let l,c=m(e,t);return null==c&&(c={}),l=a.length?j.call(null,!1,!1,c,r,n,o,s,i,...a):j(!1,!1,c,r,n,o,s,i),y(e,t,l)}function C(e,t){const r=Array.isArray(t)?t:[t];let n=!1;for(let t=0;t<r.length;t++)if(i.call(e,r[t])){n=!0;break}if(!n)return e;const o={},a=s(e);for(let t=0;t<a.length;t++){const n=a[t];r.indexOf(n)>=0||(o[n]=e[n])}return o}function P(e,t,r,n,o,s,...i){return i.length?j.call(null,!0,!1,e,t,r,n,o,s,...i):j(!0,!1,e,t,r,n,o,s)}function j(e,t,i,...c){let d=i;null==d&&o(n?"At least one object should be provided to merge()":r);let u=!1;for(let r=0;r<c.length;r++){const n=c[r];if(null==n)continue;const o=s(n);if(o.length)for(let r=0;r<=o.length;r++){const s=o[r];if(e&&void 0!==d[s])continue;let i=n[s];t&&l(d[s])&&l(i)&&(i=j(e,t,d[s],i)),void 0!==i&&i!==d[s]&&(u||(u=!0,d=a(d)),d[s]=i)}}return d}},85704:(e,t)=>{"use strict";t.GU=void 0;class r extends Error{constructor(e,...t){super(e);const o=r.getErrorReport(this);if(1===t.length){const e=n(t[0]);this.innerErrors=[e];const s=r.getErrorReport(e);return void(this.stack=`${o}\n\n======= INNER ERROR =======\n\n${s}`)}this.innerErrors=t.map((e=>n(e)));const s=this.innerErrors.map(((e,n)=>{const o=r.getErrorReport(e);return`======= INNER ERROR (${n+1} of ${t.length}) =======\n\n${o}`})).join("\n\n");this.stack=`${o}\n\n${s}`}get innerError(){return 0===this.innerErrors.length?null:this.innerErrors[0]}static rethrow(e){return(...t)=>{throw new this(e,...t)}}}function n(e){try{return e instanceof Error?e:new Error(`Value that is not an instance of Error was thrown: ${e}`)}catch{return new Error("Failed to stringify non-instance of Error that was thrown.This is possibly due to the fact that toString() method of the valuedoesn't return a primitive value.")}}t.GU=r,r.getErrorReport="string"==typeof(new Error).stack?e=>e.stack:e=>`${e.name}: ${e.message}`,r.prototype.name="NestedError"},18377:(e,t,r)=>{"use strict";r.d(t,{e:()=>u});var n=r(50679),o=r(23013),s=r(53868),i=r(68837),a=r(52112),l=r(13516),c={horizontal:{"> *:first-of-type:not(:last-of-type)":{borderEndRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderStartRadius:0}},vertical:{"> *:first-of-type:not(:last-of-type)":{borderBottomRadius:0},"> *:not(:first-of-type):not(:last-of-type)":{borderRadius:0},"> *:not(:first-of-type):last-of-type":{borderTopRadius:0}}},d={horizontal:e=>({"& > *:not(style) ~ *:not(style)":{marginStart:e}}),vertical:e=>({"& > *:not(style) ~ *:not(style)":{marginTop:e}})},u=(0,o.R)((function(e,t){const{size:r,colorScheme:o,variant:u,className:h,spacing:p="0.5rem",isAttached:f,isDisabled:g,orientation:m="horizontal",...v}=e,y=(0,i.cx)("chakra-button__group",h),w=(0,a.useMemo)((()=>({size:r,colorScheme:o,variant:u,isDisabled:g})),[r,o,u,g]);let b={display:"inline-flex",...f?c[m]:d[m](p)};const k="vertical"===m;return(0,l.jsx)(n.l,{value:w,children:(0,l.jsx)(s.B.div,{ref:t,role:"group",__css:b,className:y,"data-attached":f?"":void 0,"data-orientation":m,flexDir:k?"column":void 0,...v})})}));u.displayName="ButtonGroup"},79622:(e,t,r)=>{"use strict";r.d(t,{S:()=>n});var n=(0,r(79017).w)({d:"M19.5,9.5h-.75V6.75A6.751,6.751,0,0,0,5.533,4.811a1.25,1.25,0,1,0,2.395.717A4.251,4.251,0,0,1,16.25,6.75V9a.5.5,0,0,1-.5.5H4.5a2,2,0,0,0-2,2V22a2,2,0,0,0,2,2h15a2,2,0,0,0,2-2V11.5A2,2,0,0,0,19.5,9.5Zm-9.5,6a2,2,0,1,1,3,1.723V19.5a1,1,0,0,1-2,0V17.223A1.994,1.994,0,0,1,10,15.5Z",displayName:"UnlockIcon"})},94592:(e,t,r)=>{"use strict";r.d(t,{q:()=>s});var n=r(79017),o=r(13516),s=(0,n.w)({displayName:"LinkIcon",path:(0,o.jsxs)("g",{fill:"currentColor",children:[(0,o.jsx)("path",{d:"M10.458,18.374,7.721,21.11a2.853,2.853,0,0,1-3.942,0l-.892-.891a2.787,2.787,0,0,1,0-3.941l5.8-5.8a2.789,2.789,0,0,1,3.942,0l.893.892A1,1,0,0,0,14.94,9.952l-.893-.892a4.791,4.791,0,0,0-6.771,0l-5.8,5.8a4.787,4.787,0,0,0,0,6.77l.892.891a4.785,4.785,0,0,0,6.771,0l2.736-2.735a1,1,0,1,0-1.414-1.415Z"}),(0,o.jsx)("path",{d:"M22.526,2.363l-.892-.892a4.8,4.8,0,0,0-6.77,0l-2.905,2.9a1,1,0,0,0,1.414,1.414l2.9-2.9a2.79,2.79,0,0,1,3.941,0l.893.893a2.786,2.786,0,0,1,0,3.942l-5.8,5.8a2.769,2.769,0,0,1-1.971.817h0a2.766,2.766,0,0,1-1.969-.816,1,1,0,1,0-1.415,1.412,4.751,4.751,0,0,0,3.384,1.4h0a4.752,4.752,0,0,0,3.385-1.4l5.8-5.8a4.786,4.786,0,0,0,0-6.771Z"})]})})},92393:(e,t,r)=>{"use strict";r.d(t,{q:()=>s});var n=r(79017),o=r(13516),s=(0,n.w)({displayName:"EditIcon",path:(0,o.jsxs)("g",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2",children:[(0,o.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,o.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})})},99282:(e,t,r)=>{"use strict";r.d(t,{Z:()=>n});var n=(0,r(79017).w)({viewBox:"0 0 14 14",d:"M14,7.77 L14,6.17 L12.06,5.53 L11.61,4.44 L12.49,2.6 L11.36,1.47 L9.55,2.38 L8.46,1.93 L7.77,0.01 L6.17,0.01 L5.54,1.95 L4.43,2.4 L2.59,1.52 L1.46,2.65 L2.37,4.46 L1.92,5.55 L0,6.23 L0,7.82 L1.94,8.46 L2.39,9.55 L1.51,11.39 L2.64,12.52 L4.45,11.61 L5.54,12.06 L6.23,13.98 L7.82,13.98 L8.45,12.04 L9.56,11.59 L11.4,12.47 L12.53,11.34 L11.61,9.53 L12.08,8.44 L14,7.75 L14,7.77 Z M7,10 C5.34,10 4,8.66 4,7 C4,5.34 5.34,4 7,4 C8.66,4 10,5.34 10,7 C10,8.66 8.66,10 7,10 Z",displayName:"SettingsIcon"})},69756:(e,t,r)=>{"use strict";r.d(t,{u:()=>l});var n=r(54322),o=r(54419),s=r(26345),i=Symbol.for("BeaconPlugin"),a=class e{constructor(t){this.name="Beacon",this.symbol=e.Symbol,this.beaconContext={view:void 0},this.hooks={buildBeacon:new n.BD,cancelBeacon:new n.jJ,publishBeacon:new n.Jk},t?.plugins&&t.plugins.forEach((e=>{e.apply(this)})),t?.callback&&this.hooks.publishBeacon.tap("BeaconCallback",(e=>{t.callback&&t.callback(e)}))}apply(e){this.player=e,this.logger=e.logger,e.hooks.state.tap(this.name,(e=>{"in-progress"===e.status&&(this.resolveDataRefs=t=>(0,o.NC)(t,{model:e.controllers.data,evaluate:e.controllers.expression.evaluate}))})),e.hooks.viewController.tap(this.name,(e=>{this.beaconContext={view:void 0},e.hooks.view.tap(this.name,(e=>{let t=!1;e.hooks.parser.tap(this.name,(e=>{e.hooks.onCreateASTNode.tap(this.name,(e=>{if("asset"!==e?.type&&"view"!==e?.type)return;const t=e.plugins?.stringResolver?.propertiesToSkip??[];return t.includes("beacon")?void 0:(e.plugins=(0,s.Oe)(e.plugins??{},["stringResolver","propertiesToSkip"],["beacon",...t]),e)}))})),e.hooks.onUpdate.tap(this.name,(e=>{this.beaconContext={view:e},t||(this.beacon({action:"viewed",element:"view",asset:e,view:e}),t=!0)}))}))})),e.hooks.expressionEvaluator.tap(this.name,(e=>{e.addExpressionFunction("beacon",((e,t,r)=>{const n=this.beaconContext.view||{};this.beacon({action:t,data:r,element:"view",asset:n,view:n})}))}))}beacon(e){const{action:t,element:r,asset:n,view:o}=e,{view:s}=this.beaconContext;setTimeout((async()=>{const i=e?.data||e.asset?.metaData?.beacon,a=this.resolveDataRefs?.(i)??i,l={action:t,element:r,data:a,assetId:n?.id,viewId:s?.id},c=this.player?.getState(),d={...e,data:a,state:c,view:o??s,logger:this.logger};let u=await this.hooks.buildBeacon.call(l,d)||l;u!==l&&this.resolveDataRefs&&(u=this.resolveDataRefs(u));this.hooks.cancelBeacon.call(d)||!1||(this.logger?.debug("Sending beacon event",u),this.hooks.publishBeacon.call(u))}),0)}};a.Symbol=i;var l=a},75104:(e,t,r)=>{"use strict";r.d(t,{O:()=>l});var n=r(30160),o=r(45907);function s(e,t=[],r=new Map){for(const n of Object.keys(e)){const o=e[n],i=[...t,n];"object"==typeof o?s(o,i,r):r.set(i,o)}return r}function i(e){const t=s(e),r=e=>{for(const r of Array.from(t)){const[t,n]=r;if(o(e,t)!==n)return!1}return!0};return r.count=t.size,r}var a=()=>new n([],(e=>e.matcher.count)),l=class{constructor(e){this.store=a(),e?.forEach((([e,t])=>{this.set(e,t)}))}set(e,t){const r="object"==typeof e?i(e):function(e){const t=t=>e===t;return t.count=1,t}(e);this.store.insert({key:e,value:t,matcher:r})}get(e){for(const t of this.store.array)if(t.matcher(e))return t.value}forEach(e){for(const t of this.store.array)e(t)}clear(){this.store=a()}isRegistryEmpty(){return 0===this.store.array.length}}},54419:(e,t,r)=>{"use strict";r.d(t,{Pv:()=>pe,ai:()=>yt,NC:()=>Ee});var n=r(54322),o=r(85704),s=r(45907),i=r(26345),a=Object.prototype.hasOwnProperty;function l(e,t,r){for(r of e.keys())if(c(r,t))return r}function c(e,t){var r,n,o;if(e===t)return!0;if(e&&t&&(r=e.constructor)===t.constructor){if(r===Date)return e.getTime()===t.getTime();if(r===RegExp)return e.toString()===t.toString();if(r===Array){if((n=e.length)===t.length)for(;n--&&c(e[n],t[n]););return-1===n}if(r===Set){if(e.size!==t.size)return!1;for(n of e){if((o=n)&&"object"==typeof o&&!(o=l(t,o)))return!1;if(!t.has(o))return!1}return!0}if(r===Map){if(e.size!==t.size)return!1;for(n of e){if((o=n[0])&&"object"==typeof o&&!(o=l(t,o)))return!1;if(!c(n[1],t.get(o)))return!1}return!0}if(r===ArrayBuffer)e=new Uint8Array(e),t=new Uint8Array(t);else if(r===DataView){if((n=e.byteLength)===t.byteLength)for(;n--&&e.getInt8(n)===t.getInt8(n););return-1===n}if(ArrayBuffer.isView(e)){if((n=e.byteLength)===t.byteLength)for(;n--&&e[n]===t[n];);return-1===n}if(!r||"object"==typeof e){for(r in n=0,e){if(a.call(e,r)&&++n&&!a.call(t,r))return!1;if(!(r in t)||!c(e[r],t[r]))return!1}return Object.keys(t).length===n}}return e!=e&&t!=t}var d=r(43762),u=r(91189),h=r(75104),p=Object.defineProperty,f=e=>({name:"Value",value:e}),g="'",m="`",v=e=>{if(!e)return!1;const t=e.charCodeAt(0);return!(32===t||34===t||39===t||40===t||41===t||42===t||46===t||61===t||91===t||93===t||96===t||123===t||125===t)},y=e=>{let t=1,r=e.charAt(0);const n=n=>{if(n&&r!==n)throw new Error(`Expected char: ${n} but got: ${r}`);return r=e.charAt(t),t+=1,r},o=()=>{for(;" "===r;)n()},s=()=>(()=>{if("{"===r){n("{"),n("{");const e=c();return n("}"),n("}"),e}})()??(()=>{if(r===m){n(m);let e=r;for(;n()&&r!==m;)e+=r;if(n(m),e)return{name:"Expression",value:e}}})()??(()=>{if(!v(r))return;let e=r;for(;n()&&v(r);)e+=r;return e?f(e):void 0})(),i=()=>{if(o(),r===g||'"'===r){const e=r===g;n(e?g:'"');const t=(e=>{if(!r?.match(e))return;let t=r;for(;n()&&r?.match(e);)t+=r;return t?f(t):void 0})(/[^'"]+/);return n(e?g:'"'),t}return s()},a=()=>{if("["===r){n("["),o();let e=i();if(!e)throw new Error("Expected identifier");if(o(),(()=>{if("="!==r)return!1;for(;"="===r;)n();return!0})()){o();e=((e,t)=>({name:"Query",key:e,value:t}))(e,i()),o()}return e&&n("]"),e}},l=()=>{const e=[],t=(()=>{const e=[];let t=s();for(;void 0!==t;)e.push(t),t=s();var r;if(0!==e.length)return 1===(r=e).length?r[0]:{name:"Concatenated",value:r}})();if(t){e.push(t);let r=a();for(;void 0!==r;)e.push(r),r=a()}return e},c=()=>{const e=[];let t=l();for(;void 0!==t&&(e.push(...t),r&&"}"!==r);){if(0===t.length&&r)throw new Error(`Unexpected character: ${r}`);n("."),t=l()}return(e=>({name:"PathNode",path:e}))(e)};try{return{status:!0,path:c()}}catch(e){return{status:!1,error:e.message}}};function w(e){return!("string"==typeof e||Array.isArray(e))}var b=class e{constructor(t,r=(t=>new e(t))){const n=Array.isArray(t)?t:t.split(".");this.split=n.map((e=>{if("number"==typeof e)return e;const t=Number(e);return isNaN(t)?e:t})),Object.freeze(this.split),this.joined=this.split.join("."),this.factory=r}asArray(){return this.split}asString(){return this.joined}contains(e){const t=e.asArray();if(t.length<this.split.length)return!1;for(let e=0;e<this.split.length;e++)if(this.split[e]!==t[e])return!1;return!0}relative(e){return this.asArray().slice(e.asArray().length)}parent(){return this.factory(this.split.slice(0,-1))}key(){return this.split[this.split.length-1]}descendent(e){const t=(r=e,Array.isArray(r)?r:"string"==typeof r?r.split("."):r.asArray());var r;return this.factory(this.split.concat(t))}};function k(e,t,r){const n={updates:{},path:[]};function s(e){if("Value"===e.name)return e.value;if("PathNode"===e.name){const r=k(e,t);r.updates&&(n.updates={...n.updates,...r.updates});try{return t.convertToPath(t.getValue(r.path))}catch(e){throw new o.GU(`Unable to resolve path segment: ${r.path}`,e)}}if("Expression"===e.name)try{const r=t.evaluate(e.value);return t.convertToPath(r)}catch(t){throw new o.GU(`Unable to resolve path: ${e.value}`,t)}throw new Error(`Unable to resolve value for node: ${e.name}`)}function i(e){"string"==typeof e&&e.indexOf(".")>-1?e.split(".").forEach((e=>{n.path.push(function(e){const t=parseInt(e,10);return isNaN(t)?e:t}(e))})):n.path.push(e)}return e.path.forEach((function(e){const o=r?.beforeResolveNode.call(e,{...n,...t})??e;switch(o.name){case"Expression":case"PathNode":i(s(o));break;case"Value":i(o.value);break;case"Query":{const e=t.getValue(n.path)??[],{key:r,value:i}=o,a=s(r),l=i&&s(i),c=function(e,t,r){return e.findIndex((e=>!(!e||"object"!=typeof e)&&e[t]==r))}(e,a,l);void 0===c||-1===c?(n.updates[[...n.path,e.length,a].join(".")]=l,n.path.push(e.length)):n.path.push(c);break}case"Concatenated":n.path.push(o.value.map(s).join(""));break;default:throw new Error(`Unsupported node type: ${o.name}`)}})),{path:n.path,updates:Object.keys(n.updates??{}).length>0?n.updates:void 0}}var x=/[\s()*=`{}'"[\]]/,E=/^[^.]+(\..+)*$/,S={get:()=>{throw new Error("Not Implemented")},set:()=>{throw new Error("Not Implemented")},evaluate:()=>{throw new Error("Not Implemented")}},C=class{constructor(e){this.hooks={skipOptimization:new n.jJ,beforeResolveNode:new n.hj},this.parserOptions={...S,...e},this.cache={},this.parseCache={},this.parse=this.parse.bind(this)}normalizePath(e,t){if(!x.test(e)&&E.test(e)&&!0!==this.hooks.skipOptimization.call(e))return{path:e.split("."),updates:void 0};const r=this.parseCache[e]??y(e);if(this.parseCache[e]=r,"object"!=typeof r||!r?.status)throw new TypeError(`Cannot normalize path "${e}": ${r?.error??"Unknown Error."}`);try{return k(r.path,t,this.hooks)}catch(t){throw new o.GU(`Cannot resolve binding: ${e}`,t)}}getBindingForNormalizedResult(e){const t=e.path.join(".");if(this.cache[t])return this.cache[t];const r=new b(""===t?[]:e.path,this.parse);return this.cache[t]=r,r}parse(e,t={}){if(w(e))return e;const r={...this.parserOptions,...t};let n={};const o=Array.isArray(e)?e.join("."):String(e),s={getValue:e=>{const t=this.normalizePath(e.join("."),s);return r.get(this.getBindingForNormalizedResult(t))},evaluate:e=>r.evaluate(e),convertToPath:e=>{if(void 0===e)throw new Error("Attempted to convert undefined value to binding path");if("string"!=typeof e&&"number"!=typeof e&&"boolean"!=typeof e)throw new Error(`Attempting to convert ${typeof e} to a binding path.`);const t=this.normalizePath(String(e),s);t.updates&&(n={...n,...t.updates});const r=t.path.join(".");if(""===r)throw new Error("Nested path resolved to an empty path");return r}},i=this.normalizePath(o,s);i.updates&&(n={...n,...i.updates});const a=Object.keys(n);if(!r.readOnly&&a.length>0){const e=a.map((e=>[this.parse(e),n[e]]));r.set(e)}return this.getBindingForNormalizedResult(i)}},P=class{constructor(){this.readDeps=new Set,this.writeDeps=new Set,this.namedDependencySets={},this.namedSet="core",this.createSubset("core"),this.createSubset("children")}createSubset(e,t=!1){!t&&this.namedDependencySets[e]||(this.namedDependencySets[e]={readDeps:new Set,writeDeps:new Set})}getDependencies(e){return void 0!==e?this.namedDependencySets?.[e]?.readDeps??new Set:this.readDeps}trackSubset(e){this.createSubset(e),this.namedSet=e}trackDefault(){this.namedSet="core"}getModified(e){return void 0!==e?this.namedDependencySets?.[e]?.writeDeps??new Set:this.writeDeps}readsBinding(e){return this.readDeps.has(e)}writesBinding(e){return this.writeDeps.has(e)}reset(){this.readDeps=new Set,this.writeDeps=new Set,this.namedDependencySets={},this.namedSet="core",this.createSubset("core",!0),this.createSubset("children",!0)}addReadDep(e,t=this.namedSet){t&&this.namedDependencySets?.[t]?.readDeps.add(e),this.readDeps.add(e)}addWriteDep(e,t=this.namedSet){t&&this.namedDependencySets?.[t]?.writeDeps.add(e),this.writeDeps.add(e)}addChildReadDep(e){this.addReadDep(e,"children")}},j=class extends P{constructor(e){super(),this.rootModel=e,this.set=this.set.bind(this),this.get=this.get.bind(this)}set(e,t){return e.forEach((([e])=>this.addWriteDep(e))),this.rootModel.set(e,t)}get(e,t){return this.addReadDep(e),this.rootModel.get(e,t)}delete(e,t){return this.addWriteDep(e),this.rootModel.delete(e,t)}},R=new class{get(){}set(){return[]}delete(){}},A=new b([]);function V(e,t,r){return r?{get:(n,o)=>{const s=o??t;return e.get?e.get(n,s,r):r?.get(n,s)},set:(n,o)=>{const s=o??t;return e.set?e.set(n,s,r):r?.set(n,s)},delete:(n,o)=>{const s=o??t;return e.delete?e.delete(n,s,r):r?.delete(n,s)}}:e}function N(e){if(0===e.length)return R;if(1===e.length)return V(e[0]);function t(t){return e.reduce(((e,r)=>V(r,t,e)),void 0)??R}return{get:(e,r)=>t(r)?.get(e,r),set:(e,r)=>t(r)?.set(e,r),delete:(e,r)=>t(r)?.delete(e,r)}}var O=class{constructor(e=[]){this.hooks={onSet:new n.Jk},this.pipeline=e,this.effectiveDataModel=N(this.pipeline)}setMiddleware(e){this.pipeline=e,this.effectiveDataModel=N(e)}addMiddleware(e){this.pipeline=[...this.pipeline,e],this.effectiveDataModel=N(this.pipeline)}reset(e={}){this.pipeline.forEach((e=>{"reset"in e&&e.reset?.()})),this.set([[A,e]])}set(e,t){const r=this.effectiveDataModel.set(e,t);return this.hooks.onSet.call(e),r}get(e,t){return this.effectiveDataModel.get(e,t)}delete(e,t){return this.effectiveDataModel.delete(e,t)}},T=class{constructor(e={}){this.model=e,this.get=this.get.bind(this),this.set=this.set.bind(this)}reset(e={}){this.model=e}get(e){return e&&e.asString()?s(this.model,e.asArray()):this.model}set(e){const t=[];return e.forEach((([e,r])=>{const n=this.get(e);this.model=(0,i.Oe)(this.model,e.asArray(),r),t.push({binding:e,oldValue:n,newValue:r})})),t}delete(e){const t=e.parent();if(t){const r=this.get(t);void 0!==r&&(Array.isArray(r)?this.model=(0,i.Oe)(this.model,t.asArray(),(0,i.Wq)(r,e.key())):this.model=(0,i.Oe)(this.model,t.asArray(),(0,i.cJ)(r,e.key())))}}},B=Symbol("Expression Node ID");function M(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&e.__id===B}var $=46,D=40,_=123,z=125,F=!0,U={"-":F,"!":F,"~":F,"+":F},I={"=":3,"+=":3,"-=":3,"&=":3,"|=":3,"||":5,"&&":6,"|":7,"^":8,"&":9,"==":10,"!=":10,"===":10,"!==":10,"<":11,">":11,"<=":11,">=":11,"<<":12,">>":12,">>>":12,"+":13,"-":13,"*":14,"/":14,"%":14};function L(e,t){const r=new Error(`${e} at character ${t}`);throw r.index=t,r.description=e,r}function J(e,t){if(e&&t)return{start:e.start,end:t.end}}function G(e){let t=0;return Object.keys(e).forEach((r=>{r.length>t&&Object.prototype.hasOwnProperty.call(e,r)&&(t=r.length)})),t}var H=G(U),q=G(I),W={true:!0,false:!1,null:null,undefined:void 0};function K(e){return I[e]||0}function Z(e,t,r,n){let o;return o="||"===e||"&&"===e?"LogicalExpression":"="===e?"Assignment":"+="===e||"-="===e||"&="===e||"|="===e?"Modification":"BinaryExpression",{__id:B,type:o,operator:e,left:t,right:r,location:n}}function Y(e){return e>=48&&e<=57}function Q(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122}function X(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57}function ee(e,t){const r=t?.strict??!0,n=e.charAt,o=e.charCodeAt,{length:s}=e;let i=0;const a=e=>({start:{character:e},end:{character:i}});function l(t){return n.call(e,t)}function c(t){return o.call(e,t)}function d(){let e=c(i);for(;32===e||9===e;)e=c(++i)}function u(){const e=function(){let e,t,r,n=p(),o=h();if(!o)return n;let s={value:o,prec:K(o)},a=p();a||L(`Expected expression after ${o}`,i);const l=[n,s,a];o=h();for(;o&&(t=K(o),0!==t);){for(s={value:o,prec:t};l.length>2&&t<=l[l.length-2].prec;)a=l.pop(),o=l.pop().value,n=l.pop(),e=Z(o,n,a,J(n.location,a.location)),l.push(e);e=p(),e||L(`Expected expression after ${o}`,i),l.push(s,e),o=h()}r=l.length-1,e=l[r];for(;r>1;)e=Z(l[r-1].value,l[r-2],e,J(l[r-2].location,e.location)),r-=2;return e}();d();const t=i;if(i<s&&63===c(i)){i++;const r=u();if(r||L("Expected expression",i),d(),58===c(i)){i++;const n=u();return n||L("Expected expression",i),{__id:B,type:"ConditionalExpression",test:e,consequent:r,alternate:n,location:a(t)}}L("Expected :",i)}return e}function h(){d();let t=e.substr(i,q),r=t.length;for(;r>0;){if(Object.prototype.hasOwnProperty.call(I,t))return i+=r,t;t=t.substr(0,--r)}return!1}function p(){d();const t=c(i),r=i;if(Y(t)||46===t)return function(){let e="";const t=i;for(;Y(c(i));)e+=l(i++);if(c(i)===$)for(e+=l(i++);Y(c(i));)e+=l(i++);let r=l(i);if("e"===r||"E"===r){for(e+=l(i++),r=l(i),"+"!==r&&"-"!==r||(e+=l(i++));Y(c(i));)e+=l(i++);Y(c(i-1))||L(`Expected exponent (${e}${l(i)})`,i)}const n=c(i);Q(n)?L(`Variable names cannot start with a number (${e}${l(i)})`,i):n===$&&L("Unexpected period",i);return{__id:B,type:"Literal",value:parseFloat(e),raw:e,location:a(t)}}();if(39===t||34===t)return f();if(Q(t)||40===t)return function(){let e=c(i),t=e===D?function(){i++;const e=u();if(d(),41===c(i))return i++,e;L("Unclosed (",i)}():g();const r=i;d(),e=c(i);for(;e===$||91===e||e===D;)i++,e===$?(d(),t={__id:B,type:"MemberExpression",computed:!1,object:t,property:g(),location:a(r)}):91===e?(t={__id:B,type:"MemberExpression",computed:!0,object:t,property:u(),location:a(r)},d(),e=c(i),93!==e&&L("Unclosed [",i),i++):e===D&&(t={__id:B,type:"CallExpression",args:m(41),callTarget:t,location:a(r)}),d(),e=c(i);return t}();if(91===t)return function(){const e=i;return i++,{__id:B,type:"ArrayExpression",elements:m(93),location:a(e)}}();if(n=t,o=c(i+1),n===_&&o===_)return function(){let e="",t=!1,r=1;const n=i;i+=2;for(;i<s;){const n=l(i++);if("}"===n&&c(i)===z){if(i++,r--,0===r){t=!0;break}e+="}}"}else"{"===n&&c(i)===_?(r++,e+="{{",i++):e+=n}t||L(`Unclosed brace after "${e}"`,i);return{__id:B,type:"ModelRef",ref:e,location:a(n)}}();var n,o;if(t===_)return function(){const e=[];let t,r,n,o=!1,l=!0;const h=i;for(++i;i<s;){if(d(),n=c(i),125===n){t&&L("A key was defined but a value was not",i),i++,o=!0;break}l?(39!==n&&34!==n&&L("An object must start wtih a key",i),t=f(),d(),58===c(i)?(i++,l=!1):L("A colon must follow an object key",i)):(r=u(),e.push({key:t,value:r}),d(),n=c(i),44===n?i++:125!==n&&L("Please add a comma to add another key",i),l=!0,t=void 0,r=void 0),n=c(i)}return o||L("Unclosed brace in object",i),{__id:B,type:"Object",attributes:e,location:a(h)}}();let h=e.substr(i,H),v=h.length;for(;v>0;){if(Object.prototype.hasOwnProperty.call(U,h))return i+=v,{__id:B,type:"UnaryExpression",operator:h,argument:p(),prefix:!0,location:a(r)};h=h.substr(0,--v)}return!1}function f(){const e=l(i++);let t="",r=!1;const n=i;for(;i<s;){let n=l(i++);if(n===e){r=!0;break}if("\\"===n)switch(n=l(i++),n){case"n":t+="\n";break;case"r":t+="\r";break;case"t":t+="\t";break;case"b":t+="\b";break;case"f":t+="\f";break;case"v":t+="\v"}else t+=n}return r||L(`Unclosed quote after "${t}"`,i),{__id:B,type:"Literal",value:t,raw:`${e}${t}${e}`,location:a(n)}}function g(){const t=i;let r=c(t);for(Q(r)?i++:L(`Unexpected ${l(i)}`,i);i<s&&(r=c(i),X(r));)i++;const n=e.slice(t,i);return Object.prototype.hasOwnProperty.call(W,n)?{__id:B,type:"Literal",value:W[n],raw:n,location:a(t)}:"this"===n?{__id:B,type:"ThisExpression",location:a(t)}:{__id:B,type:"Identifier",name:n,location:a(t)}}function m(e){const t=[];let n,o;for(;i<s;){if(d(),n=c(i),n===e){i++;break}44!==n?(o=u(),o&&"Compound"!==o.type||L("Expected comma",i),t.push(o)):i++}return r&&n!==e&&L(`Expected ${String.fromCharCode(e)}`,i),t}const v=[];try{for(;i<s;){const e=c(i);if(59===e||44===e){i++;continue}const t=u();t?v.push(t):r&&i<s&&L(`Unexpected "${l(i)}"`,i)}return 1===v.length?v[0]:{__id:B,type:"Compound",body:v,location:a(0)}}catch(e){if(r||!(e instanceof Error))throw e;return{__id:B,type:"Compound",body:v,location:a(0),error:e}}}var te={};((e,t)=>{for(var r in t)p(e,r,{get:t[r],enumerable:!0})})(te,{conditional:()=>se,deleteDataVal:()=>oe,getDataVal:()=>ne,setDataVal:()=>re});var re=(e,t,r)=>{e.model.set([[t,r]])},ne=(e,t)=>e.model.get(t),oe=(e,t)=>e.model.delete(t),se=(e,t,r,n)=>e.evaluate(t)?e.evaluate(r):n?e.evaluate(n):null;function ie(e){return!M(e)&&("object"==typeof e&&null!==e&&!Array.isArray(e)&&"value"in e)}se.resolveParams=!1;var ae=(e,t,r)=>e.evaluate(t)&&e.evaluate(r);ae.resolveParams=!1;var le=(e,t,r)=>e.evaluate(t)||e.evaluate(r);le.resolveParams=!1;var ce={"+":(e,t)=>e+t,"-":(e,t)=>e-t,"*":(e,t)=>e*t,"/":(e,t)=>e/t,"%":(e,t)=>e%t,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,">":(e,t)=>e>t,">=":(e,t)=>e>=t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,"&&":ae,"||":le,"!==":(e,t)=>e!==t,"===":(e,t)=>e===t,"|":(e,t)=>e|t,"&":(e,t)=>e&t,"+=":(e,t)=>e+t,"-=":(e,t)=>e-t,"&=":(e,t)=>e&t,"|=":(e,t)=>e|t},de={"-":e=>-e,"+":e=>Number(e),"!":e=>!e},ue=class{constructor(e){this.vars={},this.hooks={resolve:new n.hj,resolveOptions:new n.hj,beforeEvaluate:new n.hj,onError:new n.jJ},this.expressionsCache=new Map,this.operators={binary:new Map(Object.entries(ce)),unary:new Map(Object.entries(de)),expressions:new Map(Object.entries(te))},this.defaultHookOptions={...e,evaluate:e=>this.evaluate(e,this.defaultHookOptions),resolveNode:e=>this._execAST(e,this.defaultHookOptions)},this.hooks.resolve.tap("ExpressionEvaluator",this._resolveNode.bind(this)),this.evaluate=this.evaluate.bind(this)}reset(){this.expressionsCache.clear()}evaluate(e,t){const r=this.hooks.resolveOptions.call({...this.defaultHookOptions,...t,resolveNode:e=>this._execAST(e,r)});let n=this.hooks.beforeEvaluate.call(e,r)??e;for(;ie(n);)n=n.value;return"number"==typeof n||"boolean"==typeof n||null==n?n:M(n)?this._execAST(n,r):Array.isArray(n)?n.reduce(((e,r)=>this.evaluate(r,t)),null):this._execString(String(n),r)}addExpressionFunction(e,t){this.operators.expressions.set(e,t)}addBinaryOperator(e,t){this.operators.binary.set(e,t)}addUnaryOperator(e,t){this.operators.unary.set(e,t)}setExpressionVariable(e,t){this.vars[e]=t}getExpressionVariable(e){return this.vars[e]}_execAST(e,t){return this.hooks.resolve.call(void 0,e,t)}_execString(e,t){if(""===e)return e;const r=e.match(/^@\[(.*)\]@$/);let n,s=e;r&&([,s]=Array.from(r));try{n=this.expressionsCache.get(s)??ee(s,{strict:t.strict}),this.expressionsCache.set(s,n)}catch(r){if(t.throwErrors||!this.hooks.onError.call(r))throw new o.GU(`Error parsing expression: ${e}`,r);return}try{return this._execAST(n,t)}catch(r){if(t.throwErrors||!this.hooks.onError.call(r))throw new o.GU(`Error evaluating expression: ${e}`,r)}}_resolveNode(e,t,r){const{resolveNode:n,model:o}=r,s={...r,evaluate:e=>this.evaluate(e,r)};if("Literal"===t.type)return t.value;if("Identifier"===t.type)return this.vars[t.name];if("Compound"===t.type||"ThisExpression"===t.type)throw new Error(`Expression type: ${t.type} is not supported`);if("BinaryExpression"===t.type||"LogicalExpression"===t.type){const e=this.operators.binary.get(t.operator);return e?"resolveParams"in e?!1===e.resolveParams?e(s,t.left,t.right):e(s,n(t.left),n(t.right)):e(n(t.left),n(t.right)):void 0}if("UnaryExpression"===t.type){const e=this.operators.unary.get(t.operator);return e?"resolveParams"in e?e(s,!1===e.resolveParams?t.argument:n(t.argument)):e(n(t.argument)):void 0}if("Object"===t.type){const{attributes:e}=t,r={};return e.forEach((e=>{const t=n(e.key),o=n(e.value);r[t]=o})),r}if("CallExpression"===t.type){const e=t.callTarget.name,r=this.operators.expressions.get(e);if(!r)throw new Error(`Unknown expression function: ${e}`);if("resolveParams"in r&&!1===r.resolveParams)return r(s,...t.args);return r(s,...t.args.map((e=>n(e))))}if("ModelRef"===t.type)return o.get(t.ref,{context:{model:r.model}});if("MemberExpression"===t.type){return n(t.object)[n(t.property)]}if("Assignment"!==t.type){if("ConditionalExpression"===t.type){const e=n(t.test)?t.consequent:t.alternate;return n(e)}if("ArrayExpression"===t.type)return t.elements.map((e=>n(e)));if("Modification"===t.type){const e=this.operators.binary.get(t.operator);if(e){let r;return r="resolveParams"in e?!1===e.resolveParams?e(s,t.left,t.right):e(s,n(t.left),n(t.right)):e(n(t.left),n(t.right)),"ModelRef"===t.left.type?o.set([[t.left.ref,r]]):"Identifier"===t.left.type&&(this.vars[t.left.name]=r),r}return n(t.left)}}else{if("ModelRef"===t.left.type){const e=n(t.right);return o.set([[t.left.ref,e]]),e}if("Identifier"===t.left.type){const e=n(t.right);return this.vars[t.left.name]=e,e}}}},he=()=>{},pe=class{constructor(){this.trace=he,this.debug=he,this.info=he,this.warn=he,this.error=he}},fe=class{constructor(){this.hooks={trace:new n.Jk,debug:new n.Jk,info:new n.Jk,warn:new n.Jk,error:new n.Jk,log:new n.Jk},this.logHandlers=new Set,this.trace=this.createHandler("trace"),this.debug=this.createHandler("debug"),this.info=this.createHandler("info"),this.warn=this.createHandler("warn"),this.error=this.createHandler("error")}createHandler(e){return(...t)=>{this.hooks[e].call(t),this.hooks.log.call(e,t),this.logHandlers.forEach((r=>r[e](...t)))}}addHandler(e){this.logHandlers.add(e)}removeHandler(e){this.logHandlers.delete(e)}},ge=class{constructor(e){this.trace=this.createHandler("trace"),this.debug=this.createHandler("debug"),this.info=this.createHandler("info"),this.warn=this.createHandler("warn"),this.error=this.createHandler("error"),this.proxiedLoggerProvider=e}createHandler(e){return(...t)=>{const r=this.proxiedLoggerProvider();r?.[e](...t)}}},me=e=>e;var ve=class{constructor(e){this.formatters=new Map,this.types=new Map,this.schema=new Map,this.bindingSchemaNormalizedCache=new Map,this.hooks={resolveTypeForBinding:new n.hj},this.schema=e?function(e){const t=new Map;if(!e.ROOT)return t;const r=[{node:e.ROOT,path:[],visited:new Set}];for(;r.length>0;){const n=r.shift();if(!n)break;const{node:o,path:s,visited:i}=n;Object.entries(o).forEach((([n,o])=>{const a=[...s,n],l=a.join(".");if(t.has(l))throw new Error("Path has already been processed. There's either a loop somewhere or a bug");if(i.has(o.type))throw new Error(`Path already contained type: ${o.type}. This likely indicates a loop in the schema`);t.set(l,o),o.isArray&&a.push("[]"),o.isRecord&&a.push("{}"),o.type&&e[o.type]&&r.push({path:a,node:e[o.type],visited:new Set([...i,o.type])})}))}return t}(e):new Map}addFormatters(e){e.forEach((e=>{this.formatters.set(e.name,e)}))}addDataTypes(e){e.forEach((e=>{this.types.set(e.type,e)}))}getValidationsForBinding(e){const t=this.getApparentType(e);if(t?.validation?.length)return t.validation.map((e=>({severity:"error",trigger:"change",...e})))}normalizeBinding(e){const t=this.bindingSchemaNormalizedCache.get(e);if(t)return t;let r=e.asArray(),n=r.map((e=>"number"==typeof e?"[]":e)).join(".");return n&&(this.bindingSchemaNormalizedCache.set(e,n),r=n.split(".")),r.forEach((t=>{const o=r.map((e=>e===t?"{}":e)).join(".");this.schema.get(o)&&(this.bindingSchemaNormalizedCache.set(e,o),r=o.split("."),n=o)})),n}getType(e){return this.hooks.resolveTypeForBinding.call(this.schema.get(this.normalizeBinding(e)),e)}getApparentType(e){const t=this.getType(e);if(void 0===t)return;const r=this.getTypeDefinition(t?.type);return void 0===r?t:{...r,...t,validation:[...t.validation??[],...r.validation??[]]}}getTypeDefinition(e){return this.types.get(e)}getFormatterForType(e){const{type:t,...r}=e,n=this.formatters.get(t);if(n)return{format:n.format?e=>n.format?.(e,r):me,deformat:n.deformat?e=>n.deformat?.(e,r):me}}getFormatter(e){const t=this.getApparentType(e);if(t?.format)return this.getFormatterForType(t.format)}},ye="{{",we="}}";function be(e){const t=e.indexOf(ye);if(-1===t)return;let r=1,n=t+ye.length,o=e.substring(t+ye.length);for(;r>0&&o.length>0;){const e=o.indexOf(we);if(-1===e)break;const t=o.indexOf(ye);-1!==t&&t<e?(r++,o=o.substring(t+ye.length),n+=t+ye.length):(r--,o=o.substring(e+we.length),n+=e+we.length)}if(0!==r)throw new Error(`Unbalanced {{ and }} in exp: ${e}`);return{start:t,end:n}}function ke(e,t){const{model:r,formatted:n=!0}=t;let o=function(e,{evaluate:t}){if(!t)return e;const r=/@\[.*?\]@/;let n=e,o=n.match(r);for(;null!==o;){const s=o[0],i=n.indexOf(s),a=t(s.substr(2,s.length-2-2));if(0===i&&s===e&&"string"!=typeof a)return a;n=n.substr(0,i)+a+n.substr(i+s.length),o=n.match(r)}return n}(e,t);if(!r||"string"!=typeof o||-1===o.indexOf(ye))return o;for(;-1!==o.indexOf(ye);){const e=be(o);if(!e)return o;const{start:t,end:s}=e,i=o.substring(t+ye.length,s-ye.length).trim(),a=r.get(i,{formatted:n});if(0===t&&s===o.length&&"string"!=typeof a)return a;o=o.substr(0,t)+a+o.substr(s)}return o}function xe(e,t){switch(typeof e){case"string":return ke(e,t);case"object":{if(!e)return e;const r=Object.keys(e);let n=e;return r.length>0&&r.forEach((r=>{n=(0,i.Oe)(n,[r],xe(e[r],t))})),n}default:return e}}function Ee(e,t){return xe(e,t)}function Se(e,t){const r=new Map(e),n=t.parent(),o=t.key();if(r.forEach(((e,n)=>{(t===n||t.contains(n))&&r.delete(n)})),"number"==typeof o){Array.from(e.keys()).filter((e=>{if(n.contains(e)){const[t]=e.relative(n);return"number"==typeof t&&t>o}return!1})).sort().forEach((e=>{const[t,...o]=e.relative(n);if("number"==typeof t){const s=[t-1,...o],i=n.descendent(s);r.set(i,r.get(e)),r.delete(e)}}))}return r}var Ce=class{constructor(e,t){this.validator=e,this.shadowModelPaths=new Map,this.logger=t?.logger,this.shouldIncludeInvalid=t?.shouldIncludeInvalid}set(e,t,r){const n=V(this,{...t,includeInvalid:!0},r),o=[],s=new Set;e.forEach((([e,t])=>{this.shadowModelPaths.set(e,t),s.add(e)}));const i=[];this.shadowModelPaths.forEach(((e,t)=>{const r=this.validator(t,n);void 0===r?o.push([t,e]):r instanceof Set?r.forEach((r=>{i.push(r.binding),r.isStrong||r.binding.asString()!==t.asString()||o.push([r.binding,e])})):s.has(t)&&(i.push(t),this.logger?.debug(`Invalid value for path: ${t.asString()} - ${r.severity} - ${r.message}`))}));let a=[];if(r&&o.length>0){o.forEach((([e])=>this.shadowModelPaths.delete(e)));const e=r.set(o,t);if(0===i.length)return e;a=e}const l=i.map((e=>({binding:e,oldValue:n.get(e),newValue:n.get(e),force:!0})));return[...a,...l]}get(e,t,r){let n=r?.get(e,t);return(this.shouldIncludeInvalid?.(t)??!0===t?.includeInvalid)&&this.shadowModelPaths.forEach(((t,r)=>{r!==e?e.contains(r)&&(n=(0,i.Oe)(n,r.relative(e),t)):n=t})),n}delete(e,t,r){return this.shadowModelPaths=Se(this.shadowModelPaths,e),r?.delete(e,t)}},Pe=class{constructor(){this.registry=new Map}get(e){return this.registry.get(e)}register(e,t){this.registry.set(e,t)}};function je(e,t){return Object.hasOwnProperty.call(e,"template")&&Array.isArray(e?.template)&&e.template.length&&e.template.find((e=>e.output===t))}function Re(e){return"staticSwitch"===e||"dynamicSwitch"===e}function Ae(e){return"template"===e}var Ve={type:"empty"},Ne=class{constructor(){this.hooks={onParseObject:new n.hj,onCreateASTNode:new n.hj,parseNode:new n.jJ}}parseView(e){const t=this.parseObject(e,"view");if(!t)throw new Error("Unable to parse object into a view");return t}createASTNode(e,t){const r=this.hooks.onCreateASTNode.call(e,t);return void 0===r?e:r}parseObject(e,t="value",r={templateDepth:0}){const n=this.hooks.parseNode.call(e,t,r);if(n||null===n)return n;const o=(e,n,s=[])=>{if("object"!=typeof n||null===n)return{value:n,children:[]};const a=this.hooks.onParseObject.call(n,t);if(!a)return e;const l={children:[],value:e};return(Array.isArray(a)?a.map(((e,t)=>[t,e])):[...Object.entries(a),...Object.getOwnPropertySymbols(a).map((e=>[e,a[e]]))]).reduce(((e,t)=>{let{value:n}=e;const{children:l}=e,[c,d]=t,u=this.hooks.parseNode.call(d,"value",r,{path:s,key:c,parentObj:a});if(u)l.push(...u);else if(d&&"object"==typeof d){const t=o(e.value,d,[...s,c]);n=t.value,l.push(...t.children)}else n=(0,i.Oe)(e.value,[...s,c],d);return{value:n,children:l}}),l)},{value:s,children:a}=o(void 0,e),l=void 0!==s||a.length?{type:t,value:s}:void 0;if(l&&a.length){const e=l;e.children=a,a.forEach((t=>{t.value.parent=e}))}return this.hooks.onCreateASTNode.call(l,e)??null}};function Oe(e,t){if(!e||!t)return!0;const r=Array.from(t.values()),n=Array.from(e.values());return void 0!==r.find((e=>!!n.find((t=>t===e||t.contains(e)||e.contains(t)))))}function Te(e){return{...e,data:{model:e.model,formatValue:(t,r)=>e.formatValue?e.formatValue(t,r):r,format:(t,r)=>e.format?e.format(w(t)?t:e.parseBinding(t),r):r},evaluate:t=>e.evaluator.evaluate(t,e)}}function Be(e,t){Array.isArray(e)?e.forEach((e=>{Be(e,t)})):t.push(e)}var Me=class{constructor(e,t){this.hooks={skipResolve:new n.hj,beforeUpdate:new n.Jk,afterUpdate:new n.Jk,resolveOptions:new n.hj,beforeResolve:new n.hj,resolve:new n.hj,afterResolve:new n.hj,afterNodeUpdate:new n.Jk},this.root=e,this.options=t,this.resolveCache=new Map,this.ASTMap=new Map,this.logger=t.logger,this.idCache=new Set}getSourceNode(e){return this.ASTMap.get(e)}update(e){this.hooks.beforeUpdate.call(e);const t=new Map;this.idCache.clear();const r=new Map(this.ASTMap);this.ASTMap.clear();const n=this.computeTree(this.root,void 0,e,t,Te(this.options),void 0,r);return this.resolveCache=t,this.hooks.afterUpdate.call(n.value),n.value}getResolveCache(){return new Map(this.resolveCache)}getPreviousResult(e){if(!e)return;const t=0===this.resolveCache.size,r=function(e){if(e)return"value"in e&&"object"==typeof e.value&&"string"==typeof e.value?.id?e.value.id:void 0}(e);if(r){if(this.idCache.has(r))return void(t&&("asset"===e.type||"view"===e.type?this.logger?.error(`Cache conflict: Found Asset/View nodes that have conflicting ids: ${r}, may cause cache issues.`):"value"===e.type&&this.logger?.info(`Cache conflict: Found Value nodes that have conflicting ids: ${r}, may cause cache issues. To improve performance make value node IDs globally unique.`)));this.idCache.add(r)}return this.resolveCache.get(e)}cloneNode(e){const t=(0,i.o8)(e);return Object.keys(t).forEach((e=>{if("parent"===e)return;const r=t[e];"object"==typeof r&&null!==r&&(t[e]=Array.isArray(r)?[...r]:{...r})})),t}computeTree(e,t,r,n,o,a,l){const d=new j(o.data.model);d.trackSubset("core");const u=(h=function(e,t){function r(r,n){const o=w(r)?r:t(r,{get:e.get,set:e.set,readOnly:n});if(!o)throw new Error("Unable to parse binding");return o}return{get:(t,n)=>e.get(r(t,!0),n),set:(t,n)=>e.set(t.map((([e,t])=>[r(e,!1),t])),n),delete:(t,n)=>e.delete(r(t,!1),n)}}(d,this.options.parseBinding),{get:(e,t)=>h.get(e,{context:{model:h},...t}),set:(e,t)=>h.set(e,{context:{model:h},...t}),delete:(e,t)=>h.delete(e,{context:{model:h},...t})});var h;const p=this.hooks.resolveOptions.call({...o,data:{...o.data,model:u},evaluate:e=>this.options.evaluator.evaluate(e,{model:u}),node:e},e),f=this.getPreviousResult(e),g=f?.dependencies,m=Oe(r,g),v=this.hooks.skipResolve.call(!m,e,p),y={...this.cloneNode(e),parent:a},b=this.hooks.beforeResolve.call(y,p)??{type:"empty"},k="multi-node"===b.type&&"multi-node"===a?.parent?.type&&"value"===a.type;if(f&&v){const r={...f,updated:!1},o=(e,t,r)=>{const{node:s}=e;this.ASTMap.set(s,t);const i={...e,updated:!1};n.set(t,i);const a=e=>{const r=l.get(e)??e,n=this.getPreviousResult(r);n&&o(n,r,t)};"children"in s?s.children?.forEach((({value:e})=>a(e))):"multi-node"===s.type&&s.values.forEach(a),this.hooks.afterNodeUpdate.call(t,r,i)};return f.node.parent=a,o(f,e,t),r}b.parent=a,p.node=b,this.ASTMap.set(b,e);let x=this.hooks.resolve.call(void 0,b,p),E=!c(f?.value,x);f&&!E&&(x=f?.value);const S=new Set;if(d.trackSubset("children"),"children"in b){const t=b.children?.map((t=>{const o=this.computeTree(t.value,e,r,n,p,b,l),{dependencies:a,node:c,updated:d,value:u}=o;if(a.forEach((e=>S.add(e))),u)if("multi-node"!==c.type||c.override)x=(0,i.Oe)(x,t.path,u);else{const e=(0,i.sh)(s(x,t.path,[]),u);x=(0,i.Oe)(x,t.path,e)}return E=E||d,{...t,value:c}}));b.children=t}else if("multi-node"===b.type){const t=[],o=k?a?.parent:e,s=b.values.map((e=>{const s=this.computeTree(e,o,r,n,p,b,l);return void 0!==s.value&&null!==s.value&&("multi-node"===s.node.parent?.type&&Array.isArray(s.value)?s.value.forEach((e=>{Be(e,t)})):t.push(s.value)),s.dependencies.forEach((e=>S.add(e))),E=E||s.updated,s.node}));b.values=s,x=t}S.forEach((e=>d.addChildReadDep(e))),d.trackSubset("core"),f&&!E&&(x=f?.value),x=this.hooks.afterResolve.call(x,b,{...p,getDependencies:e=>d.getDependencies(e)});const C={node:b,updated:E,value:x,dependencies:new Set([...d.getDependencies(),...S])};return this.hooks.afterNodeUpdate.call(e,k?a?.parent:t,C),n.set(e,C),C}},$e=class{constructor(e,t,r){this.allValidations=new Set,this.byBinding=new Map,this.logger=r,this.parse(e,t)}parse(e,t){const r=e.validation;void 0!==r&&(Array.isArray(r)?r.forEach((e=>{const r={trigger:"navigation",severity:"error",...e};this.allValidations.add(r);const{ref:n}=e;if(n){const e=t(n);this.byBinding.has(e)?this.byBinding.get(e)?.push(r):this.byBinding.set(e,[r])}})):this.logger?.warn(`Unable to register view validations for id: ${e.id}. 'validation' property must be an Array.`))}getValidationsForBinding(e){return this.byBinding.get(e)}},De=class{constructor(e,t){this.hooks={onUpdate:new n.Jk,parser:new n.Jk,resolver:new n.Jk,onTemplatePluginCreated:new n.Jk,templatePlugin:new n.Jk},this.initialView=e,this.resolverOptions=t,this.hooks.onTemplatePluginCreated.tap("view",(e=>{this.templatePlugin=e}))}updateAsync(){const e=this.resolver?.update();this.lastUpdate=e,this.hooks.onUpdate.call(e)}update(e){if(void 0===this.rootNode){this.validationProvider=new $e(this.initialView,this.resolverOptions.parseBinding,this.resolverOptions.logger),this.templatePlugin?this.hooks.templatePlugin.call(this.templatePlugin):this.resolverOptions.logger?.warn("templatePlugin not set for View, legacy templates may not work");const e=new Ne;this.hooks.parser.call(e),this.rootNode=e.parseView(this.initialView),this.resolver=new Me(this.rootNode,{...this.resolverOptions,parseNode:e.parseObject.bind(e)}),this.hooks.resolver.call(this.resolver)}const t=this.resolver?.update(e);return this.lastUpdate===t?this.lastUpdate:(this.lastUpdate=t,this.hooks.onUpdate.call(t),t)}getValidationsForBinding(e){return this.validationProvider?.getValidationsForBinding(e)}},_e=class{constructor(e){this.hooks={resolveTemplateSubstitutions:new n.hj},this.options=e}parseTemplate(e,t,r){const{template:n,depth:o}=t,s=r.data.model.get(t.data);if(!s)return null;if(!Array.isArray(s))throw new Error(`Template using '${t.data}' but is not an array`);const i=[];s.forEach(((r,s)=>{const a=this.hooks.resolveTemplateSubstitutions.call([{expression:new RegExp(`_index${o||""}_`),value:String(s)}],{depth:o,data:r,index:s});let l=JSON.stringify(n);for(const{expression:e,value:t}of a){let r="g";"object"==typeof e&&(r=`${e.flags}${e.global?"":"g"}`),l=l.replace(new RegExp(e,r),t)}const c=e(JSON.parse(l),"value",{templateDepth:t.depth+1});c&&i.push(c)}));return{type:"multi-node",override:!1,values:i}}applyParser(e){e.hooks.onCreateASTNode.tap("template",(t=>t&&"template"===t.type&&!t.dynamic?this.parseTemplate(e.parseObject.bind(e),t,this.options):t)),e.hooks.parseNode.tap("template",((t,r,n,o)=>{if(o&&Ae(o.key))return t.map((t=>{const r=e.createASTNode({type:"template",depth:n.templateDepth??0,data:t.data,template:t.value,dynamic:t.dynamic??!1},t);if(r)return"multi-node"===r.type&&r.values.forEach((e=>{e.parent=r})),{path:[...o.path,t.output],value:r}})).filter(Boolean)}))}applyResolverHooks(e){e.hooks.beforeResolve.tap("template",((e,t)=>e&&"template"===e.type&&e.dynamic?this.parseTemplate(t.parseNode,e,t):e))}apply(e){e.hooks.parser.tap("template",this.applyParser.bind(this)),e.hooks.resolver.tap("template",this.applyResolverHooks.bind(this))}},ze=(e,t)=>r=>{const n=r.indexOf(e);if(-1===n)return!1;const o=r.indexOf(t);return-1!==o&&n<o},Fe=ze("{{","}}"),Ue=ze("@[","]@");function Ie(e,t){return function(e){return Fe(e)||Ue(e)}(e)?Ee(e,{model:t.data.model,evaluate:t.evaluate}):e}function Le(e,t,r){if(null==e||"object"!=typeof e&&"string"!=typeof e)return e;if("string"==typeof e)return Ie(e,t);let n=e;return Object.keys(e).forEach((o=>{if(r.has(o))return;const s=e[o];let a=s;"object"==typeof s?a=Le(s,t,r):"string"==typeof s&&(a=Ie(s,t)),a!==s&&(n=(0,i.hZ)(n,o,a))})),n}var Je=(e,t)=>{const r=e.parent;if(!r)return[];if("children"in r){const n=t.getSourceNode(e);return r.children?.find((e=>e.value===n))?.path??[]}return"multi-node"!==r.type?[]:Je(r,t)},Ge=class{constructor(){this.propertiesToSkipCache=new Map}applyResolver(e){e.hooks.resolve.tap("string-resolver",((t,r,n)=>{if("empty"===r.type||"unknown"===r.type)return null;if("value"===r.type||"asset"===r.type||"view"===r.type){let t;"asset"===r.type||"view"===r.type?(t=new Set(r.plugins?.stringResolver?.propertiesToSkip??["exp"]),r.value?.id&&this.propertiesToSkipCache.set(r.value.id,t)):t="multi-node"===r.parent?.type&&("asset"===r.parent?.parent?.type||"view"===r.parent?.parent?.type)&&r.parent.parent.value?.id&&this.propertiesToSkipCache.has(r.parent.parent.value.id)?this.propertiesToSkipCache.get(r.parent.parent.value.id):new Set(["exp"]);const o=Je(r,e);return o.length>0&&o.some((e=>t.has(e.toString())))?r.value:Le(r.value,n,t)}return t}))}apply(e){e.hooks.resolver.tap("string-resolver",this.applyResolver.bind(this))}},He=class{isApplicability(e){return e&&Object.prototype.hasOwnProperty.call(e,"applicability")}applyResolver(e){e.hooks.beforeResolve.tap("applicability",((e,t)=>{let r=e;if("applicability"===e?.type){if(!1===t.evaluate(e.expression))return null;r=e.value}return r}))}applyParser(e){e.hooks.parseNode.tap("applicability",((t,r,n,o)=>{if(this.isApplicability(t)){const s=e.parseObject((0,i.cJ)(t,"applicability"),r,n);if(!s)return o?[]:null;const a=e.createASTNode({type:"applicability",expression:t.applicability,value:s},t);return a?("applicability"===a.type&&(a.value.parent=a),o?[{path:[...o.path,o.key],value:a}]:a):o?[]:null}}))}apply(e){e.hooks.resolver.tap("applicability",this.applyResolver.bind(this)),e.hooks.parser.tap("applicability",this.applyParser.bind(this))}},qe=class{constructor(e){this.options=e}resolveSwitch(e,t){for(const r of e.cases){if(t.evaluate(r.case))return r.value}return Ve}isSwitch(e){return e&&(Object.prototype.hasOwnProperty.call(e,"dynamicSwitch")||Object.prototype.hasOwnProperty.call(e,"staticSwitch"))}applyParser(e){e.hooks.onCreateASTNode.tap("switch",(e=>e&&"switch"===e.type&&!e.dynamic?this.resolveSwitch(e,this.options):e)),e.hooks.parseNode.tap("switch",((t,r,n,o)=>{if(this.isSwitch(t)||o&&Re(o.key)){const r=o&&Re(o.key)?{[o.key]:t}:t,s="dynamicSwitch"in r,i=(s?r.dynamicSwitch:r.staticSwitch).map((t=>{const{case:r,...o}=t,s=e.parseObject(o,"value",n);if(s)return{case:r,value:s}})).filter(Boolean),a=e.createASTNode({type:"switch",dynamic:s,cases:i},r);if(!a||"empty"===a.type)return o?[]:null;if("switch"===a.type&&a.cases.forEach((e=>{e.value.parent=a})),o){let e=[...o.path,o.key],t=a;if("value"===a.type&&1===a.children?.length&&void 0===a.value){const r=a.children[0];e=[...e,...r.path],t=r.value}return[{path:e,value:t}]}return a}}))}applyResolver(e){e.hooks.beforeResolve.tap("switch",((e,t)=>e&&"switch"===e.type&&e.dynamic?this.resolveSwitch(e,t):e))}apply(e){e.hooks.parser.tap("switch",this.applyParser.bind(this)),e.hooks.resolver.tap("switch",this.applyResolver.bind(this))}},We=class{applyParser(e){e.hooks.parseNode.tap("multi-node",((t,r,n,o)=>{if(o&&!Ae(o.key)&&Array.isArray(t)){const r=t.map((t=>e.parseObject(t,"value",n))).filter((e=>!!e));if(!r.length)return[];const s=e.createASTNode({type:"multi-node",override:!je(o.parentObj,o.key),values:r},t);return s?("multi-node"===s.type&&s.values.forEach((e=>{e.parent=s})),[{path:[...o.path,o.key],value:s}]):[]}}))}apply(e){e.hooks.parser.tap("multi-node",this.applyParser.bind(this))}},Ke=class{applyParser(e){e.hooks.parseNode.tap("asset",((t,r,n,o)=>{if("asset"===o?.key&&"object"==typeof t){const r=e.parseObject(t,"asset",n);return r?[{path:[...o.path,o.key],value:r}]:[]}}))}apply(e){e.hooks.parser.tap("asset",this.applyParser.bind(this))}},Ze=class{constructor(e,t,r){this.isTransitioning=!1,this.hooks={beforeStart:new n.jJ,onStart:new n.Jk,onEnd:new n.Jk,skipTransition:new n.jJ,beforeTransition:new n.hj,resolveTransitionNode:new n.hj,transition:new n.Jk,afterTransition:new n.Jk},this.id=e,this.flow=t,this.log=r?.logger,this.history=[],this.hooks.transition.tap("startPromise",(async(e,t)=>{const r=t.value;this.flowPromise&&"END"===r.state_type&&this.flowPromise.resolve(r)}))}async start(){if(this.flowPromise)return this.log?.warn("Already called start for flow"),this.flowPromise.promise;this.flow=this.hooks.beforeStart.call(this.flow)||this.flow,this.flow.onStart&&this.hooks.onStart.call(this.flow.onStart);const e=this.flow.startState;return e?(this.flowPromise=d(),this.pushHistory(e),this.flowPromise.promise):Promise.reject(new Error("No 'startState' defined for flow"))}transition(e,t){if(this.isTransitioning)throw new Error(`Transitioning while ongoing transition from ${this.currentState?.name} is in progress is not supported`);if("END"===this.currentState?.value.state_type)return void this.log?.warn(`Skipping transition using ${e}. Already at and END state`);if(void 0===this.currentState)throw new Error("Cannot transition when there's no current state");if(t?.force)this.log?.debug("Forced transition. Skipping validation checks");else{if(this.hooks.skipTransition.call(this.currentState))return void this.log?.debug(`Skipping transition from ${this.currentState.name} b/c hook told us to`)}const r=this.hooks.beforeTransition.call(this.currentState.value,e);if(!("transitions"in r))throw new Error(`No transitions defined for ${this.currentState.value}`);const{transitions:n}=r,o=n[e]||n["*"];if(void 0!==o)return this.log?.debug(`Transitioning from ${this.currentState.name} to ${o} using ${e} `),this.pushHistory(o,t);this.log?.warn(`No transition from ${this.currentState.name} using ${e} or *`)}pushHistory(e,t){if(!Object.prototype.hasOwnProperty.call(this.flow,e))throw new Error(`No flow definition for: ${e} was found.`);let r=this.flow[e];if(!this.flow[e]||"object"!=typeof r||!("state_type"in r))return void this.log?.error(`Flow doesn't contain any states named: ${e}`);const n=this.currentState;this.isTransitioning=!0,r=this.hooks.resolveTransitionNode.call(r);const o={name:e,value:r};this.currentState=o,this.history.push(e),"END"===o.value.state_type&&this.flow.onEnd&&this.hooks.onEnd.call(this.flow.onEnd),this.hooks.transition.call(n,{...o}),this.isTransitioning=!1,this.hooks.afterTransition.call(this)}},Ye=class{constructor(e,t){this.hooks={flow:new n.Jk},this.navigation=e,this.navStack=[],this.log=t?.logger,this.start=this.start.bind(this),this.run=this.run.bind(this),this.transition=this.transition.bind(this),this.addNewFlow=this.addNewFlow.bind(this)}transition(e,t){if(void 0===this.current)throw new Error("Not currently in a flow. Cannot transition.");this.current.transition(e,t)}addNewFlow(e){this.navStack.push(e),this.current=e,this.hooks.flow.call(e)}async run(e){if(!Object.prototype.hasOwnProperty.call(this.navigation,e))return Promise.reject(new Error(`No flow defined for: ${e}`));const t=this.navigation[e];if(null===t||"object"!=typeof t)return Promise.reject(new Error(`Flow: ${e} needs to be an object`));this.log?.debug(`Starting flow: ${e}`);const r=new Ze(e,t,{logger:this.log});this.addNewFlow(r),r.hooks.afterTransition.tap("flow-controller",(e=>{if("FLOW"===e.currentState?.value.state_type){const t=e.currentState?.value.ref;this.log?.debug(`Loading subflow ${t}`),this.run(t).then((t=>{this.log?.debug(`Subflow ended. Using outcome: ${t.outcome}`),e.transition(t?.outcome)}))}}));const n=await r.start();if(this.navStack.pop(),this.navStack.length>0){const e=0;this.current=this.navStack[e]}return n}async start(){return this.navigation.BEGIN?this.run(this.navigation.BEGIN):Promise.reject(new Error("Must supply a BEGIN state"))}},Qe=/%([a-zA-Z]+)/g;var Xe="validation-binding-tracker",et=class{constructor(e){this.trackedBindings=new Set,this.options=e}getBindings(){return this.trackedBindings}trackBinding(e){this.trackedBindings.has(e)||(this.trackedBindings.add(e),this.options.callbacks?.onAdd?.(e))}applyResolver(e){this.trackedBindings.clear();const t=new Map,r=new Map;let n;const o=new Map;let s=new Map;const i=new Map,a=new Map;e.hooks.beforeUpdate.tap(Xe,(e=>{n=e})),e.hooks.skipResolve.tap(Xe,((e,t)=>{const r=o.get(t);if(!e||!n||!r)return e;return 0===new Set([...n].filter((e=>r.has(e)))).size})),e.hooks.resolveOptions.tap(Xe,((e,n)=>{if(void 0===e.validation)return e;t.delete(n);const s=e=>{const o=w(e)?e:this.options.parseBinding(e);t.has(n)?t.get(n)?.add(o):t.set(n,new Set([o]));let{parent:s}=n;for(;s;){if(r.has(s)){r.get(s)?.add(n);break}s=s.parent}this.trackedBindings.add(o),this.options.callbacks?.onAdd?.(o)};return{...e,validation:{...e.validation,get:(t,r)=>{r?.track&&s(t);const n=e.validation?._getValidationForBinding(t)?.getAll(r),o=n?.find((e=>"field"===e.displayTarget||void 0===e.displayTarget));return o},getValidationsForBinding:(t,r)=>(r?.track&&s(t),e.validation?._getValidationForBinding(t)?.getAll(r)??[]),getChildren:t=>{const r=new Array;return o.get(n)?.forEach((n=>{const o=e.validation?._getValidationForBinding(n)?.get();!o||void 0!==t&&t!==o.displayTarget||r.push(o)})),r},getValidationsForSection:()=>{const t=new Array;return i.get(n)?.forEach((r=>{const n=e.validation?._getValidationForBinding(r)?.get();n&&"section"===n.displayTarget&&t.push(n)})),t},register:e=>{"section"===e?.type&&(r.has(n)||r.set(n,new Set))},track:s}}})),e.hooks.afterNodeUpdate.tap(Xe,((n,l,c)=>{const{updated:d,node:u}=c;if(a.set(u,n),d){const e=new Set(t.get(n));"multi-node"===u.type&&u.values.forEach((t=>s.get(t)?.forEach((t=>e.add(t))))),"children"in u&&u.children&&u.children.forEach((t=>{s.get(t.value)?.forEach((t=>e.add(t)))})),s.set(u,e)}else s.set(u,o.get(n)??new Set);n===e.root&&(this.trackedBindings=new Set(s.get(u)),o.clear(),s.forEach(((e,t)=>{const r=a.get(t);r&&o.set(r,e)})),i.clear(),r.forEach(((e,r)=>{const n=new Set;e.forEach((e=>{t.get(e)?.forEach(n.add,n)})),i.set(r,n)})),t.clear(),r.clear(),s=new Map)}))}apply(e){e.hooks.resolver.tap(Xe,this.applyResolver.bind(this))}},tt=Symbol.for("validation-provider-name");var rt=class{constructor(e,t,r,n){this.applicableValidations=[],this.validationsByState={load:[],change:[],navigation:[]},this.onDismiss=t,e.forEach((e=>{const{trigger:t}=e;if(this.validationsByState[t]){const r={value:n=e,type:n.severity,state:"none",isBlockingNavigation:!1};this.validationsByState[t].push(r)}else r?.warn(`Unknown validation trigger: ${t}`);var n})),this.weakBindings=n??new Set}get allValidations(){return Object.values(this.validationsByState).flat()}checkIfBlocking(e){if("active"===e.state){const{isBlockingNavigation:t}=e;return t}return!1}getAll(){return this.applicableValidations.reduce(((e,t)=>("active"===t.state&&t.response&&e.push({...t.response,blocking:this.checkIfBlocking(t)}),e)),[])}get(){const e=this.applicableValidations.find((e=>"active"===e.state&&e.response));if("active"===e?.state)return{...e.response,blocking:this.checkIfBlocking(e)}}runApplicableValidations(e,t,r){this.applicableValidations=this.applicableValidations.map((n=>{if("dismissed"===n.state)return n;const o=n.value.blocking??("warning"!==n.value.severity||"once"),s=(0,i.Oe)(n,["value","blocking"],o),a=!0===o||"once"===o&&!t;if("navigation"===r&&"active"===s.state&&!0!==s.value.blocking&&"warning"===s.value.severity){const e=s;return!e.dismissable||!e.response.dismiss||"once"===e.response.blocking&&e.response.blocking?("once"===e?.response.blocking&&(e.response.blocking=!1),e.dismissable=!0):e.response.dismiss(),e}const l=e(s.value),c={type:s.type,value:s.value,state:l?"active":"none",isBlockingNavigation:a,dismissable:"warning"===s.value.severity&&"navigation"===r,response:l?{...s.value,message:l.message??"Something is broken",severity:s.value.severity,displayTarget:s.value.displayTarget??"field"}:void 0};return"active"===c.state&&"warning"===s.value.severity&&(c.response.dismiss=()=>{c.state="dismissed",this.onDismiss?.()}),c}))}update(e,t,r){const n=[];"load"===e&&void 0!==this.currentPhase||("navigation"!==this.currentPhase&&e!==this.currentPhase?("load"===e?(this.currentPhase="load",this.applicableValidations=[...this.validationsByState.load]):"change"===e&&"load"===this.currentPhase?(this.currentPhase="change",this.applicableValidations=[...this.applicableValidations,...this.validationsByState.change]):"navigation"!==e||"load"!==this.currentPhase&&"change"!==this.currentPhase||(this.applicableValidations.forEach((e=>{"error"===e.type&&"active"===e.state&&!1===e.isBlockingNavigation||n.push(e)})),this.applicableValidations=[...n,...this.validationsByState.navigation,..."load"===this.currentPhase?this.validationsByState.change:[]],this.currentPhase="navigation"),this.runApplicableValidations(r,t,e)):this.runApplicableValidations(r,t,e))}},nt=class{constructor(e,t){this.hooks={createValidatorRegistry:new n.Jk,onAddValidation:new n.hj,onRemoveValidation:new n.hj,resolveValidationProviders:new n.hj,onTrackBinding:new n.Jk},this.validations=new Map,this.weakBindingTracker=new Set,this.schema=e,this.options=t,this.reset()}setOptions(e){this.options=e}getDataMiddleware(){return[{set:(e,t,r)=>r?.set(e,t)??[],get:(e,t,r)=>r?.get(e,t),delete:(e,t,r)=>(this.validations=Se(this.validations,e),r?.delete(e,t))},new Ce((e=>{if(!this.options)return;this.updateValidationsForBinding(e,"change",this.options);const t=this.getValidationForBinding(e);if("error"===t?.get()?.severity)return t.get();const r=new Set;return this.validations.forEach(((t,n)=>{Oe(new Set([e]),t.weakBindings)&&"error"===t?.get()?.severity&&t?.weakBindings.forEach((e=>{e===n?r.add({binding:e,isStrong:!0}):r.add({binding:e,isStrong:!1})}))})),r.size>0?r:void 0}),{logger:new ge((()=>this.options?.logger))})]}getValidationProviders(){return this.providers||(this.providers=this.hooks.resolveValidationProviders.call([{source:"schema",provider:this.schema},{source:"view",provider:{getValidationsForBinding:e=>this.viewValidationProvider?.getValidationsForBinding?.(e),getValidationsForView:()=>this.viewValidationProvider?.getValidationsForView?.()}}])),this.providers}reset(){this.validations.clear(),this.tracker=void 0}onView(e){if(this.validations.clear(),!this.options)return;const t=new et({...this.options,callbacks:{onAdd:t=>{if(!this.options||void 0!==this.getValidationForBinding(t))return;const r=this.options.model.get(t);r!==this.options.model.get(t,{ignoreDefaultValue:!0})&&this.options.model.set([[t,r]],{silent:!0}),this.updateValidationsForBinding(t,"load",this.options,(()=>{e.update(new Set([t]))})),this.hooks.onTrackBinding.call(t)}}});this.tracker=t,this.viewValidationProvider=e,t.apply(e)}updateValidationsForBinding(e,t,r,n){const o=r??this.options;if(!o)throw new Error("Context is required for executing validations");if("load"===t){const t=this.getValidationProviders().reduce(((t,r)=>(t.push(...r.provider.getValidationsForBinding?.(e)?.map((e=>({...e,[tt]:r.source})))??[]),t)),[]);if(0===t.length)return;this.validations.set(e,new rt(t,n,this.options?.logger))}const s=this.validations.get(e);s?.update(t,!0,(t=>{const r=this.validationRunner(t,e,o);if(this.weakBindingTracker.size>0){const t=this.validations.get(e);this.weakBindingTracker.forEach((e=>t.weakBindings.add(e)))}return r?{message:r.message}:void 0})),"load"!==t&&this.validations.forEach(((r,n)=>{n!==e&&Oe(new Set([e]),r.weakBindings)&&r.update(t,!0,(e=>{const t=this.validationRunner(e,n,o);return t?{message:t.message}:void 0}))}))}validationRunner(e,t,r=this.options){if(!r)throw new Error("No context provided to validation runner");const n=e.handler??this.getValidator(e.type),o=new Set,s={get:(e,n)=>(o.add(w(e)?t:r.parseBinding(e)),r.model.get(e,{...n,includeInvalid:!0})),set:r.model.set,delete:r.model.delete},i=n?.({...r,evaluate:(e,t={model:s})=>r.evaluate(e,t),model:s,validation:e,schemaType:this.schema.getType(t)},r.model.get(t,{includeInvalid:!0,formatted:"formatted"===e.dataTarget}),e);if(this.weakBindingTracker=o,i){let{message:t}=i;const{parameters:n}=i;return e.message&&(t=Ee(e.message,{model:s,evaluate:r.evaluate}),n&&(t=function(e,t){return e.slice().replace(Qe,(e=>t[e.slice(1)]||e))}(t,n))),{message:t}}}updateValidationsForView(e){const t="navigation"===e,r=this.activeBindings,n=t=>{this.getBindings().forEach((r=>{this.validations.get(r)?.update(e,t,(e=>{if(this.options)return this.validationRunner(e,r,this.options)}))}))};if(n(!t),t){const{activeBindings:e}=this;(function(e,t){if(e.size>t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0})(e,r)&&n(!0)}}get activeBindings(){return new Set(Array.from(this.getBindings()).filter((e=>void 0!==this.validations.get(e)?.get())))}getValidator(e){if(this.validatorRegistry)return this.validatorRegistry.get(e);const t=new Pe;return this.hooks.createValidatorRegistry.call(t),this.validatorRegistry=t,t.get(e)}getBindings(){return this.tracker?.getBindings()??new Set}trackBinding(e){this.tracker?.trackBinding(e)}validateView(e="navigation"){this.updateValidationsForView(e);const t=new Map;let r=!0;return this.getBindings().forEach((n=>{const o=this.getValidationForBinding(n)?.getAll();o?.forEach((o=>{"navigation"===e&&o.blocking&&(this.options?.logger.debug(`Validation on binding: ${n.asString()} is preventing navigation. ${JSON.stringify(o)}`),r=!1),t.has(n)||t.set(n,o)}))})),{canTransition:r,validations:t.size?t:void 0}}getValidationForBinding(e){return this.validations.get(e)}forView(e){return{_getValidationForBinding:t=>this.getValidationForBinding(w(t)?t:e(t)),getAll:()=>{const e=this.getBindings();if(0===e.size)return;const t=new Map;return e.forEach((e=>{const r=this.getValidationForBinding(e)?.get();r&&t.set(e,r)})),0===t.size?void 0:t},get(){throw new Error("Error Access be provided by the view plugin")},getValidationsForBinding(){throw new Error("Error rollup should be provided by the view plugin")},getChildren(){throw new Error("Error rollup should be provided by the view plugin")},getValidationsForSection(){throw new Error("Error rollup should be provided by the view plugin")},track:()=>{throw new Error("Tracking should be provided by the view plugin")},register:()=>{throw new Error("Section functionality should be provided by the view plugin")},type:t=>this.schema.getType(w(t)?t:e(t))}}},ot=class{constructor(e){this.updateCallback=e,this.state=new Map}removeKey(e){this.state.delete(e)}reset(){this.state.clear()}useSharedState(e){return t=>(this.state.has(e)||this.state.set(e,t),[this.state.get(e),t=>{const r=this.state.get(e);this.state.set(e,t),r!==t&&this.updateCallback?.()}])}getLocalStateFunction(e,t){return r=>{this.state.has(e)||this.state.set(e,[]),this.state.has(t)||this.state.set(t,0);const n=this.state.get(e),o=this.state.get(t);this.state.set(t,o+1),n.length<=o&&n.push(r);return[n[o],e=>{const t=n[o];n[o]=e,t!==e&&this.updateCallback?.()}]}}};function st(e,t){return e===t||!!e.parent&&st(e.parent,t)}var it=class{constructor(e){this.registry=e,this.stateStore=new Map,this.beforeResolveSymbol=Symbol("before resolve"),this.resolveSymbol=Symbol("resolve"),this.beforeResolveCountSymbol=Symbol("before resolve count"),this.resolveCountSymbol=Symbol("resolve count")}apply(e){e.hooks.view.tap("asset-transform",(e=>{this.stateStore.clear(),e.hooks.resolver.tap("asset-transform",(t=>{let r;const n=(t,n)=>{let o;const s=n===this.resolveSymbol?this.resolveCountSymbol:this.beforeResolveCountSymbol,i=this.stateStore.get(t);return i?(o=i,o.removeKey(s)):(o=new ot((()=>{(t=>{r=t,e.update(new Set)})(t)})),this.stateStore.set(t,o)),{useSharedState:e=>o.useSharedState(e),useLocalState:e=>o.getLocalStateFunction(n,s)(e)}};t.hooks.beforeResolve.tap("asset-transform",((e,t)=>{if(e&&("asset"===e.type||"view"===e.type)){const r=this.registry.get(e.value);if(r?.beforeResolve){const o=n(t.node??e,this.beforeResolveSymbol);return r.beforeResolve(e,t,o)}}return e})),t.hooks.afterUpdate.tap("asset-transform",(()=>{r=void 0})),t.hooks.skipResolve.tap("asset-transform",((e,t)=>{if(!e||!r)return e;const n=st(r,t),o=st(t,r);return!n&&!o})),t.hooks.afterResolve.tap("asset-transform",((e,r,o)=>{if("asset"!==r.type&&"view"!==r.type)return e;const s=t.getSourceNode(r);if(!s)return e;const i=this.registry.get(e);if(i?.resolve){const t=n(s,this.resolveSymbol);return i?.resolve(e,o,t)}return e}))}))}))}},at=class{constructor(e,t){this.hooks={resolveView:new n.hj,view:new n.Jk},this.transformRegistry=new h.O,this.optimizeUpdates=!0,this.viewOptions=t,this.viewMap=e.reduce(((e,t)=>(e[t.id]=t,e)),{}),new it(this.transformRegistry).apply(this),t.flowController.hooks.flow.tap("viewController",(e=>{e.hooks.transition.tap("viewController",((e,t)=>{"VIEW"===t.value.state_type?this.onView(t.value):this.currentView=void 0}))}));const r=(e,t=!1)=>{this.currentView&&(this.optimizeUpdates?this.queueUpdate(e,t):this.currentView.update())};t.model.hooks.onUpdate.tap("viewController",((e,t)=>{r(new Set(e.map((e=>e.binding))),t?.silent??!1)})),t.model.hooks.onDelete.tap("viewController",(e=>{const t=e.parent(),n=e.key();r("number"==typeof n&&t?new Set([t]):new Set([e]))}))}queueUpdate(e,t=!1){this.pendingUpdate?.changedBindings?this.pendingUpdate.changedBindings=new Set([...this.pendingUpdate.changedBindings,...e]):this.pendingUpdate={changedBindings:e,scheduled:!1},this.pendingUpdate.scheduled||t||(this.pendingUpdate.scheduled=!0,u((()=>{const e=this.pendingUpdate?.changedBindings;this.pendingUpdate=void 0,this.currentView?.update(e)})))}getViewForRef(e){if(this.viewMap[e])return this.viewMap[e];const t=Object.keys(this.viewMap).find((t=>e===ke(t,{model:this.viewOptions.model,evaluate:this.viewOptions.evaluator.evaluate})));return t&&this.viewMap[t]?this.viewMap[t]:void 0}onView(e){const t=e.ref,r=this.hooks.resolveView.call(this.getViewForRef(t),t,e);if(!r)throw new Error(`No view with id ${t}`);const n=new De(r,this.viewOptions);this.currentView=n,this.hooks.view.call(n),n.update()}},lt=class{constructor(e,t){this.controller=e,this.logger=t}get(e,t){return this.controller.get(e,t)}set(e,t){return this.logger?.error("Error: Tried to set in a read only instance of the DataController"),[]}delete(e,t){this.logger?.error("Error: Tried to delete in a read only instance of the DataController")}},ct=class{constructor(e,t){this.hooks={resolve:new n.hj,resolveDataStages:new n.hj,resolveDefaultValue:new n.jJ,onDelete:new n.Jk,onSet:new n.Jk,onGet:new n.Jk,onUpdate:new n.Jk,format:new n.hj,deformat:new n.hj,serialize:new n.hj},this.logger=t.logger;const r=t.middleware||[];this.baseMiddleware=[new T(e),...r],this.trash=new Set,this.pathResolver=t.pathResolver}getModel(){if(!this.model){const e=this.hooks.resolveDataStages.call(this.baseMiddleware),t=new O;t.setMiddleware(e),this.model=t}return this.model}resolveDataValue(e,t,r){return r?this.hooks.deformat.call(t,e):t}set(e,t){let r=[];r=Array.isArray(e)?e.map((([e,r])=>{const n=this.pathResolver.parse(e);return[n,this.resolveDataValue(n,r,Boolean(t?.formatted))]})):Object.keys(e).map((r=>{const n=this.pathResolver.parse(r),o=e[r];return[n,this.resolveDataValue(n,o,Boolean(t?.formatted))]}));const n=r.reduce(((e,[t,r])=>{const n=this.get(t,{includeInvalid:!0}),o={binding:t,newValue:r,oldValue:n};return c(n,r)?this.logger?.debug(`Skipping update for path: ${t.asString()}. Value was unchanged: ${n}`):(e.push(o),this.logger?.debug(`Setting path: ${t.asString()} from: ${n} to: ${r}`)),e}),[]),o=this.getModel().set(r,t),s=new Set(n.map((e=>e.binding)));return o.forEach((e=>{s.has(e.binding)||!0!==e.force&&c(e.oldValue,e.newValue)||(this.logger?.debug(`Path: ${e.binding.asString()} was changed from: ${e.oldValue} to: ${e.newValue}`),n.push(e))})),this.hooks.onSet.call(r),n.length>0&&this.hooks.onUpdate.call(n,t),o}resolve(e,t){return Array.isArray(e)||"string"==typeof e?this.pathResolver.parse(e,{readOnly:t}):e}get(e,t){const r=e instanceof b?e:this.resolve(e,!0);let n=this.getModel().get(r,t);if(void 0===n&&!t?.ignoreDefaultValue){const e=this.hooks.resolveDefaultValue.call(r);e!==n&&(n=e)}return t?.formatted?n=this.hooks.format.call(n,r):!1===t?.formatted&&(n=this.hooks.deformat.call(n,r)),this.hooks.onGet.call(e,n),n}delete(e,t){if(!("string"==typeof e||Array.isArray(e)||e instanceof b))throw new Error("Invalid arguments: delete expects a data path (string)");const r=e instanceof b?e:this.resolve(e,!1),n=r.parent(),o=r.key(),s=this.get(n),i="object"==typeof s&&null!==s&&Object.prototype.hasOwnProperty.call(s,o);this.getModel().delete(r,t),i&&!this.get(r)&&this.trash.add(r),this.hooks.onDelete.call(r)}serialize(){return this.hooks.serialize.call(this.get(""))}makeReadOnly(){return new lt(this,this.logger)}};function dt(e,t=[],r="."){return Object.keys(e).reduce(((n,o)=>({...n,..."[object Object]"===Object.prototype.toString.call(e[o])?dt(e[o],t.concat([o])):{[t.concat([o]).join(r)]:e[o]}})),{})}function ut(e){const t=dt(e),r=[];return Object.keys(t).forEach((e=>{r.push([new b(e),t[e]])})),r}var ht=class{constructor(){this.store=new Map,this.tempStore=new Map}addConstants(e,t){this.store.has(t)?this.store.get(t)?.set(ut(e)):this.store.set(t,new T(e))}getConstants(e,t,r){const n=new b(e);return this.tempStore.get(t)?.get(n)??this.store.get(t)?.get(n)??r}setTemporaryValues(e,t){this.tempStore.has(t)?this.tempStore.get(t)?.set(ut(e)):this.tempStore.set(t,new T(e))}clearTemporaryValues(e){e?this.tempStore.get(e)?.reset():this.tempStore.forEach((e=>{e.reset()}))}},pt=class{constructor(){this.name="flow-exp-plugin"}apply(e){let t;const r=e=>{e&&t?.evaluate("object"==typeof e&&"exp"in e?e.exp:e)};e.hooks.expressionEvaluator.tap(this.name,(e=>{t=e})),e.hooks.flowController.tap(this.name,(e=>{e.hooks.flow.tap(this.name,(e=>{e.hooks.onStart.tap(this.name,(e=>r(e))),e.hooks.onEnd.tap(this.name,(e=>r(e))),e.hooks.resolveTransitionNode.intercept({call:e=>{e?.onStart&&r(e.onStart)}})}))}))}},ft=class{constructor(){this.name="flow-exp-plugin"}apply(e){let t;e.hooks.schema.tap(this.name,(e=>{var r;r=e,t=(e,t,n)=>r.getFormatterForType({type:n})?.format(t)??t})),e.hooks.expressionEvaluator.tap(this.name,(r=>{t&&r.addExpressionFunction("format",t),r.addExpressionFunction("log",((t,...r)=>{e.logger.info(...r)})),r.addExpressionFunction("debug",((t,...r)=>{e.logger.debug(...r)})),r.addExpressionFunction("eval",((e,...t)=>e.evaluate(...t)))}))}},gt={ref:Symbol("not-started"),status:"not-started"},mt=class{constructor(){this.name="default-view-plugin"}apply(e){e.hooks.viewController.tap(this.name,(e=>{e.hooks.view.tap(this.name,(e=>{const t=Te(e.resolverOptions);(new Ke).apply(e),new qe(t).apply(e),(new He).apply(e),(new Ge).apply(e);const r=new _e(t);r.apply(e),e.hooks.onTemplatePluginCreated.call(r),(new We).apply(e)}))}))}},vt=class e{constructor(e){this.logger=new fe,this.constantsController=new ht,this.state=gt,this.hooks={flowController:new n.Jk,viewController:new n.Jk,view:new n.Jk,expressionEvaluator:new n.Jk,dataController:new n.Jk,schema:new n.Jk,validationController:new n.Jk,bindingParser:new n.Jk,state:new n.Jk,onStart:new n.Jk,onEnd:new n.Jk,resolveFlowContent:new n.hj},e?.logger&&this.logger.addHandler(e.logger),this.config=e||{},this.config.plugins=[new ft,new mt,...this.config.plugins||[],new pt],this.config.plugins?.forEach((e=>{e.apply(this)}))}getPlugins(){return this.config.plugins??[]}findPlugin(e){return this.config.plugins?.find((t=>t.symbol===e))}applyTo(e,t){const r=this.findPlugin(e);r&&t(r)}registerPlugin(e){e.apply(this),this.config.plugins?.push(e)}getVersion(){return e.info.version}getCommit(){return e.info.commit}getState(){return this.state}setState(e){this.state=e,this.hooks.state.call(e)}setupFlow(e){const t=this.hooks.resolveFlowContent.call(e),r=new Ye(t.navigation,{logger:this.logger});let n,o;this.hooks.onStart.call(t),this.hooks.flowController.call(r);const s=new C({get:e=>o.get(e),set:e=>o.set(e),evaluate:e=>n.evaluate(e)});this.hooks.bindingParser.call(s);const a=s.parse,l=d(),c=new ve(t.schema);this.hooks.schema.call(c);const u=new nt(c);let h;function p(e,t){return Ee(e,{model:o,evaluate:n.evaluate,formatted:t})}return this.hooks.validationController.call(u),o=new ct(t.data,{pathResolver:s,middleware:u.getDataMiddleware(),logger:this.logger}),o.hooks.format.tap("player",((e,t)=>{const r=c.getFormatter(t);return r?r.format(e):e})),o.hooks.deformat.tap("player",((e,t)=>{const r=c.getFormatter(t);return r?r.deformat(e):e})),o.hooks.resolveDefaultValue.tap("player",(e=>c.getApparentType(e)?.default)),n=new ue({model:o,logger:this.logger}),this.hooks.expressionEvaluator.call(n),n.hooks.onError.tap("player",(e=>(l.reject(e),!0))),r.hooks.flow.tap("player",(e=>{e.hooks.beforeTransition.tap("player",((e,t)=>{const r=e.transitions[t]?t:"*";return e.onEnd&&e.transitions[r]&&("object"==typeof e.onEnd&&"exp"in e.onEnd?n?.evaluate(e.onEnd.exp):n?.evaluate(e.onEnd)),"transitions"in e&&e.transitions[r]?(0,i.Oe)(e,["transitions",r],p(e.transitions[r])):e})),e.hooks.skipTransition.tap("validation",(e=>{if("VIEW"===e?.value.state_type){const{canTransition:e,validations:t}=u.validateView("navigation");if(!e&&t){const e=new Set(t.keys());return h?.currentView?.update(e),!0}}})),e.hooks.resolveTransitionNode.tap("player",(e=>{let t=e;return"ref"in e&&(t=(0,i.Oe)(e,["ref"],p(e.ref))),"param"in e&&(t=(0,i.Oe)(e,["param"],p(e.param,!1))),t})),e.hooks.transition.tap("player",((e,t)=>{"VIEW"!==t.value.state_type&&u.reset()})),e.hooks.afterTransition.tap("player",(e=>{const t=e.currentState?.value;if(t&&"ACTION"===t.state_type){const{exp:e}=t;r?.transition(String(n?.evaluate(e)))}n.reset()}))})),this.hooks.dataController.call(o),u.setOptions({parseBinding:a,model:o,logger:this.logger,evaluate:n.evaluate,constants:this.constantsController}),h=new at(t.views||[],{evaluator:n,parseBinding:a,transition:r.transition,model:o,utils:{findPlugin:e=>this.findPlugin(e)},logger:this.logger,flowController:r,schema:c,format:(e,t)=>{const r=c.getFormatter(e);return r?.format?r.format(t):t},formatValue:(e,t)=>{const r=c.getFormatterForType(e);return r?.format?r.format(t):t},validation:{...u.forView(a),type:e=>c.getType(a(e))},constants:this.constantsController}),h.hooks.view.tap("player",(e=>{u.onView(e),this.hooks.view.call(e)})),this.hooks.viewController.call(h),{start:()=>{r.start().then((e=>({endState:p(e,!1),data:o.serialize()}))).then(l.resolve).catch((e=>{throw this.logger.error(`Something went wrong: ${e.message}`),e})).catch(l.reject).finally((()=>this.hooks.onEnd.call()))},state:{status:"in-progress",flowResult:l.promise,controllers:{data:o,view:h,flow:r,schema:c,expression:n,binding:s,validation:u},fail:l.reject,flow:t,logger:this.logger}}}async start(e){const t=Symbol(e?.id??"payload"),r=e=>this.state.ref!==t?(this.logger.warn("Received update for a flow that's not the current one"),e):(this.setState(e),e);this.setState({status:"not-started",ref:t});try{const{state:n,start:o}=this.setupFlow(e);this.setState({ref:t,...n}),o();const s={ref:t,status:"completed",flow:n.flow,controllers:{data:n.controllers.data.makeReadOnly()}};return r({...await n.flowResult,...s})}catch(n){throw r({status:"error",ref:t,flow:e,error:n}),n}}};vt.info={version:"__VERSION__",commit:"__GIT_COMMIT__"};var yt=vt},47919:(e,t,r)=>{"use strict";r.d(t,{mV:()=>y,Ti:()=>A,on:()=>w,C3:()=>k});var n=r(52112),o=r(54322);function s(){let e=()=>{},t=()=>{},r="pending";const n=new Promise(((n,o)=>{e=e=>{r="success";n(e)},t=e=>{r="failure",o(e)}}));return{resolve:e,status:r,reject:t,promise:n}}var i=Symbol("Subscribe -- Empty Value"),a=class{constructor(){this.callbacks=new Map,this.deferredResult=s(),this.lastValue=i,this.resetDeferred=null,this.publish=this.publish.bind(this),this.add=this.add.bind(this),this.remove=this.remove.bind(this)}async publish(e){await(this.resetDeferred?.promise),this.lastValue=e,this.deferredResult.resolve(e),this.callbacks.forEach((t=>t(e)))}add(e,t){const r=this.callbacks.size;return this.callbacks.set(r,e),this.lastValue!==i&&!0===t?.initializeWithPreviousValue&&e(this.lastValue),r}remove(e){this.callbacks.delete(e)}async reset(e){e&&(this.resetDeferred=s(),await e),this.lastValue!==i&&(this.deferredResult=s()),this.lastValue=i,this.callbacks.forEach((e=>e(void 0))),this.resetDeferred?.resolve(),this.resetDeferred=null}suspend(){if(this.lastValue===i)throw this.deferredResult.promise;return this.lastValue}get(){if(this.lastValue!==i)return this.lastValue}};var l=r(75104),c=r(54419),d=r(38811);const u=[],h=[];function p(e,t){if(e===t)return 0;const r=e;e.length>t.length&&(e=t,t=r);let n=e.length,o=t.length;for(;n>0&&e.charCodeAt(~-n)===t.charCodeAt(~-o);)n--,o--;let s,i,a,l,c=0;for(;c<n&&e.charCodeAt(c)===t.charCodeAt(c);)c++;if(n-=c,o-=c,0===n)return o;let d=0,p=0;for(;d<n;)h[d]=e.charCodeAt(c+d),u[d]=++d;for(;p<o;)for(s=t.charCodeAt(c+p),a=p++,i=p,d=0;d<n;d++)l=s===h[d]?a:a+1,a=u[d],i=u[d]=a>i?l>i?i+1:l:l>a?a+1:l;return i}r(69756);var f=Symbol.for("MetricsCorePlugin"),g=Symbol.for("MetricsViewBeaconPluginContext"),m=class e{constructor(t){this.symbol=e.Symbol,this.metricsPlugin=t,this.metricsPlugin.hooks.onRenderEnd.tap("MetricsViewBeaconPlugin",(e=>{e.completed&&this.resolvePendingRenderTime&&(this.resolvePendingRenderTime(e.duration),this.resolvePendingRenderTime=void 0)}))}apply(e){e.hooks.buildBeacon.intercept({context:!0,call:(e,t)=>{e&&"viewed"===t.action&&(e[this.symbol]=this.buildContext())}})}async buildContext(){return{renderTime:await this.getRenderTime(),requestTime:this.getRequestTime()}}async getRenderTime(){const{flow:e}=this.metricsPlugin.getMetrics();if(e){const t=e.timeline[e.timeline.length-1];if("render"in t&&t.render.completed)return t.render.duration}return new Promise((e=>{this.resolvePendingRenderTime=e}))}getRequestTime(){const{flow:e}=this.metricsPlugin.getMetrics();return e?.requestTime}};m.Symbol=g;var v=class{constructor(e){this.name="RequestTimeWebPlugin",this.getRequestTime=e}apply(e){e.hooks.resolveRequestTime.tap(this.name,(()=>this.getRequestTime()))}},y=n.createContext({}),w=e=>{const{registry:t}=n.useContext(y);let r;if("type"in e&&"id"in e?r=e:"asset"in e&&(r=e.asset),!r)throw Error(`Cannot determine asset type for props: ${JSON.stringify(e)}`);if("object"!=typeof r)throw Error(`Asset was not an object got (${typeof r}) instead: ${r}`);if(void 0===r.type){const t=void 0===r.id?JSON.stringify(e):`id: ${r.id}`;throw Error(`Asset is missing type for ${t}`)}if(!t||t.isRegistryEmpty())throw Error("No asset found in registry. This could happen for one of the following reasons: \n\n      1. You might have no assets registered or no plugins added to the Player instance. \n\n      2. You might have mismatching versions of React Asset Registry Context. \n\n      See https://player-ui.github.io/latest/tools/cli#player-dependency-versions-check for tips about how to debug and fix this problem");const o=t?.get(r);if(!o){const e=[];t.forEach((t=>{e.push(t.key)}));const n=e.map((e=>JSON.parse(JSON.stringify(e)).type)).reduce(((e,t)=>{const n={value:p(r.type,t),type:t};return void 0!==e&&e.value<n.value?e:n}),void 0);throw Error(`No implementation found for id: ${r.id} type: ${r.type}. Did you mean ${n.type}? \n \n      Registered Asset matching functions are listed below: \n\n      ${JSON.stringify(e)}`)}return n.createElement(o,{key:r.id,...r})},b=n.createContext({});new c.Pv;function k(e){return{id:e.id,"data-asset-type":e.type}}var x=({view:e})=>n.createElement(w,{...e}),E=class{constructor(e){this.name="view-update",this.onUpdateCallback=e}apply(e){const t=e=>{this.onUpdateCallback(e)},r=e=>{e.hooks.onUpdate.tap(this.name,t)};e.hooks.view.tap(this.name,r);const n=e.getState();if("in-progress"===n.status){const{currentView:e}=n.controllers.view;if(e){r(e);const{lastUpdate:t}=e;t&&this.onUpdateCallback(t)}}}},S="undefined"==typeof window?void 0:window,C=class{constructor(e){this.assetRegistry=new l.O,this.hooks={webComponent:new o.hj,playerComponent:new o.hj,onBeforeViewReset:new o.PI},this.viewUpdateSubscription=new a,this.options=e??{};const t=S?.__PLAYER_DEVTOOLS_PLUGIN,r=new E(this.viewUpdateSubscription.publish),n=e?.plugins??[];t&&n.push(new t);const s=n.filter((e=>Boolean(e.apply)));this.player=e?.player??new c.ai({plugins:s}),n.forEach((e=>{e.applyReact&&e.applyReact(this)})),r.apply(this.player),this.Component=this.createReactPlayerComponent(),this.reactPlayerInfo={playerVersion:this.player.getVersion(),playerCommit:this.player.getCommit(),reactPlayerVersion:"__VERSION__",reactPlayerCommit:"__GIT_COMMIT__"}}getPlayerVersion(){return this.reactPlayerInfo.playerVersion}getPlayerCommit(){return this.reactPlayerInfo.playerCommit}findPlugin(e){return this.options.plugins?.find((t=>t.symbol===e))}registerPlugin(e){e.applyReact&&(e.applyReact(this),this.options.plugins?.push(e))}getReactPlayerVersion(){return this.reactPlayerInfo.reactPlayerVersion}getReactPlayerCommit(){return this.reactPlayerInfo.reactPlayerCommit}createReactPlayerComponent(){const e=this.hooks.webComponent.call(this.createReactComp());return t=>n.createElement(d.ErrorBoundary,{fallbackRender:()=>null,onError:e=>{const t=this.player.getState();"in-progress"===t.status&&t.fail(e)}},n.createElement(b.Provider,{value:{player:this.player}},n.createElement(e,{...t})))}createReactComp(){const e=this.hooks.playerComponent.call(x);return()=>{const t=function(e){const[t,r]=n.useState(e.get());return n.useEffect((()=>{const t=e.add((e=>{r(e)}),{initializeWithPreviousValue:!0});return()=>{e.remove(t)}}),[e]),t}(this.viewUpdateSubscription);return this.viewUpdateSubscription.suspend(),n.createElement(y.Provider,{value:{registry:this.assetRegistry}},t&&n.createElement(e,{view:t}))}}setWaitForNextViewUpdate(){const e=this.hooks.onBeforeViewReset.isUsed();return this.viewUpdateSubscription.reset(e?this.hooks.onBeforeViewReset.call():void 0)}start(e){return this.setWaitForNextViewUpdate(),this.player.start(e).finally((async()=>{await this.setWaitForNextViewUpdate()}))}};function P(e){return e}var j=class{constructor({middleware:e}){this.middleware=e,this.callbacks=[]}addListener(e){return this.callbacks.push(e),()=>{this.callbacks=this.callbacks.filter((t=>t!==e))}}start(e){const t={value:"not_started",context:{playerConfig:e.playerConfig,reactPlayer:new C(e.playerConfig),manager:e.manager}};return this.setState(t),this}reset(){if("error"!==this.state?.value)throw new Error("Flow must be in error state to reset");{const{playerConfig:e,manager:t}=this.state.context;this.start({playerConfig:e,manager:t})}}restart(){if("error"!==this.state?.value)throw new Error("Flow must be in error state to restart");{const{playerConfig:e,manager:t,prevResult:r,reactPlayer:n}=this.state.context;this.setState({value:"completed",context:{playerConfig:e,manager:t,result:r,reactPlayer:n}})}}async setState(e){this.state=e,this.callbacks.forEach((t=>{t.onState(e)}));const{manager:t,reactPlayer:r,playerConfig:n}=e.context;try{const o=await this.processState(e,{manager:t,reactPlayer:r,playerConfig:n});o&&this.setState(o)}catch(e){this.setState({value:"error",context:{manager:t,reactPlayer:r,playerConfig:n,error:e}})}}async processState(e,t){if("not_started"===e.value||"completed"===e.value){const r="completed"===e.value?e.context.result:void 0,n=this.middleware?.next??P;return{value:"pending",context:{...t,prevResult:r,next:n(e.context.manager.next(r))}}}if("pending"===e.value){const r=await e.context.next;return r.done?{value:"ended",context:{...t,result:e.context.prevResult}}:{value:"loaded",context:{...t,prevResult:e.context.prevResult,flow:r.value}}}if("loaded"===e.value)return{value:"running",context:{...t,flow:e.context.flow,prevResult:e.context.prevResult,result:e.context.reactPlayer.start(e.context.flow)}};if("running"===e.value){const r=await e.context.result;return{value:"completed",context:{...t,result:r}}}}},R=new WeakMap,A=e=>{const{withRequestTime:t,RequestTimeMetricsPlugin:r}=(()=>{const e=(0,n.useRef)({});(0,n.useEffect)((()=>()=>{e.current={}}),[e]);const t=(0,n.useCallback)((()=>{const{end:t,start:r}=e.current;if(t&&r)return t-r}),[e]);return{withRequestTime:function(t){const r="undefined"==typeof performance?Date:performance;return e.current={start:r.now()},t.finally((()=>{e.current={...e.current,end:r.now()}}))},RequestTimeMetricsPlugin:(0,n.useMemo)((()=>({name:"RequestTimeMetricsPlugin",apply(e){e.applyTo(f,(e=>{new v(t).apply(e)}))}})),[t])}})(),{state:o,managedState:s}=(e=>{const t=n.useRef({_key:Symbol("managed-player")}),r=R.get(t.current)??new j({middleware:e.middleware});R.set(t.current,r);const[o,s]=n.useState(r.state);return n.useEffect((()=>{const t=r.addListener({onState:e=>{s(e)}});return void 0===r.state&&r.start(e),t}),[]),{managedState:r,state:o}})({manager:e.manager,middleware:{next:t},playerConfig:{plugins:[...e?.plugins??[],r],player:e.player}});if(n.useEffect((()=>{"ended"===o?.value?e.onComplete?.(o?.context.result):"error"===o?.value?e.onError?.(o?.context.error):"running"===o?.value&&e.onStartedFlow?.()}),[o]),n.useEffect((()=>()=>{const t=o?.context.reactPlayer.player.getState();"running"===o?.value&&"in-progress"===t?.status&&e.manager.terminate?.(t.controllers.data.serialize())}),[e.manager,o?.context.reactPlayer.player,o?.value]),"error"===o?.value){if(e.fallbackComponent)return n.createElement(e.fallbackComponent,{reset:()=>{s.reset()},retry:()=>{s.restart()},error:o.context.error});if(!e.onError)throw o.context.error}if(o?.context.reactPlayer){const{Component:e}=o.context.reactPlayer;return n.createElement(e,null)}return null}},81532:(e,t,r)=>{"use strict";r.d(t,{w1:()=>et});var n=r(52112),o=r(47919),s=class{constructor(e){this.name="web-asset-provider-plugin",this.entries=e}applyReact(e){this.entries.forEach((([t,r])=>{const n="string"==typeof t?{type:t}:t;e.assetRegistry.set(n,r)})),e.hooks.webComponent.tap(this.name,(t=>function(){return n.createElement(o.mV.Provider,{value:{registry:e.assetRegistry}},n.createElement(t,null))}))}},i=r(75104);function a(...e){const[t,...r]=e.reverse();return(e,n,o)=>{const s=t(e,n,o);return r.length?r.reduce(((e,t)=>t(e,n,o)),s):s}}function l(...e){const t=[],r=[];for(const n of e)"function"==typeof n?r.push(n):(n?.resolve&&r.push(n.resolve),n?.beforeResolve&&t.push(n.beforeResolve));return{beforeResolve:t.length?a(...t):void 0,resolve:r.length?a(...r):void 0}}function c(e){return"object"==typeof e?e:l(e)}var d=class{constructor(e){this.name="asset-transform",this.registry=function(e){if(Array.isArray(e)){const t=e.map((([e,t])=>[e,c(t)]));return new i.O(t)}const t=new i.O;return e.forEach((({key:e,value:r})=>{t.set(e,c(r))})),t}(e)}apply(e){e.hooks.viewController.tap(this.name,(e=>{this.registry.forEach((({key:t,value:r})=>e.transformRegistry.set(t,c(r))))}))}},u=(e,t)=>({...e,format:r=>void 0===e.binding?r:t.data.format(e.binding,r),set(r){if(void 0!==e.binding)return t.data.model.set([[e.binding,r]],{formatted:!0})},value:void 0===e.binding?"":t.data.model.get(e.binding,{includeInvalid:!0,formatted:!0}),validation:void 0===e.binding?void 0:t.validation?.get(e.binding,{track:!0}),dataType:void 0===e.binding?void 0:t.validation?.type(e.binding)});function h(e){return"Prev"===e.value}var p=l(((e,t)=>({...e,run(){if(e.exp&&t.evaluate(e.exp),e.value){const r=e.metaData?.skipValidation;t.transition?.(e.value,{force:r})}}})),(e=>h(e)&&void 0===e?.metaData?.role?{...e,metaData:{...e?.metaData,role:"back"}}:e),function(...e){return{beforeResolve:a(...e)}}((e=>{const t=e.plugins?.stringResolver?.propertiesToSkip;return t&&t.indexOf("exp")>1?e:{...e,plugins:{...e.plugins,stringResolver:{...e?.plugins?.stringResolver,propertiesToSkip:[...e.plugins?.stringResolver?.propertiesToSkip??[],"exp"]}}}}))),f=e=>{const t=e?.actions,r=t?.reduce(((e,t)=>(e[h(t.asset)?"prev":"next"].push(t),e)),{next:[],prev:[]});return{...e,segmentedActions:r}},g=e=>{const t=(e=>{const{metaData:t,placeholder:r}=e;return t.accessibility?t.accessibility:r||"Image"})(e);return{...e,altText:t}},m=(e,t)=>{const{items:r,binding:n,...o}=e,s=void 0!==n,i=s?t.data.model.get(n,{includeInvalid:!0}):void 0,a=()=>{if(s)return t.data.model.set([[n,null]])},l=(r||[]).map(((r,o)=>({...r,id:r.id??`${e.id}-choice-${o}`,select(){if(s)return t.data.model.set([[n,r.value]])},unselect:a})));return{...o,binding:n,clearSelection:a,items:l,value:i,validation:s?t.validation?.get(n,{track:!0}):void 0,dataType:s?t.validation?.type(n):void 0}},v=class{constructor(){this.name="reference-assets-transforms"}apply(e){e.registerPlugin(new d([[{type:"action"},p],[{type:"input"},u],[{type:"image"},g],[{type:"info"},f],[{type:"choice"},m]]))}};function y(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=y(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function w(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=y(e))&&(n&&(n+=" "),n+=t);return n}const b=w,k="-";function x(e){const t=function(e){const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]},o=function(e,t){if(!t)return e;return e.map((([e,r])=>[e,r.map((e=>"string"==typeof e?t+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map((([e,r])=>[t+e,r]))):e))]))}(Object.entries(e.classGroups),r);return o.forEach((([e,r])=>{C(r,n,e,t)})),n}(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:function(e){const r=e.split(k);return""===r[0]&&1!==r.length&&r.shift(),E(r,t)||function(e){if(S.test(e)){const t=S.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}}(e)},getConflictingClassGroupIds:function(e,t){const o=r[e]||[];return t&&n[e]?[...o,...n[e]]:o}}}function E(e,t){if(0===e.length)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),o=n?E(e.slice(1),n):void 0;if(o)return o;if(0===t.validators.length)return;const s=e.join(k);return t.validators.find((({validator:e})=>e(s)))?.classGroupId}const S=/^\[(.+)\]$/;function C(e,t,r,n){e.forEach((e=>{if("string"!=typeof e){if("function"==typeof e)return e.isThemeGetter?void C(e(n),t,r,n):void t.validators.push({validator:e,classGroupId:r});Object.entries(e).forEach((([e,o])=>{C(o,P(t,e),r,n)}))}else{(""===e?t:P(t,e)).classGroupId=r}}))}function P(e,t){let r=e;return t.split(k).forEach((e=>{r.nextPart.has(e)||r.nextPart.set(e,{nextPart:new Map,validators:[]}),r=r.nextPart.get(e)})),r}function j(e){if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;function o(o,s){r.set(o,s),t++,t>e&&(t=0,n=r,r=new Map)}return{get(e){let t=r.get(e);return void 0!==t?t:void 0!==(t=n.get(e))?(o(e,t),t):void 0},set(e,t){r.has(e)?r.set(e,t):o(e,t)}}}const R="!";function A(e){const t=e.separator,r=1===t.length,n=t[0],o=t.length;return function(e){const s=[];let i,a=0,l=0;for(let c=0;c<e.length;c++){let d=e[c];if(0===a){if(d===n&&(r||e.slice(c,c+o)===t)){s.push(e.slice(l,c)),l=c+o;continue}if("/"===d){i=c;continue}}"["===d?a++:"]"===d&&a--}const c=0===s.length?e:e.substring(l),d=c.startsWith(R);return{modifiers:s,hasImportantModifier:d,baseClassName:d?c.substring(1):c,maybePostfixModifierPosition:i&&i>l?i-l:void 0}}}const V=/\s+/;function N(){let e,t,r=0,n="";for(;r<arguments.length;)(e=arguments[r++])&&(t=O(e))&&(n&&(n+=" "),n+=t);return n}function O(e){if("string"==typeof e)return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=O(e[n]))&&(r&&(r+=" "),r+=t);return r}function T(e,...t){let r,n,o,s=function(a){const l=t.reduce(((e,t)=>t(e)),e());return r=function(e){return{cache:j(e.cacheSize),splitModifiers:A(e),...x(e)}}(l),n=r.cache.get,o=r.cache.set,s=i,i(a)};function i(e){const t=n(e);if(t)return t;const s=function(e,t){const{splitModifiers:r,getClassGroupId:n,getConflictingClassGroupIds:o}=t,s=new Set;return e.trim().split(V).map((e=>{const{modifiers:t,hasImportantModifier:o,baseClassName:s,maybePostfixModifierPosition:i}=r(e);let a=n(i?s.substring(0,i):s),l=Boolean(i);if(!a){if(!i)return{isTailwindClass:!1,originalClassName:e};if(a=n(s),!a)return{isTailwindClass:!1,originalClassName:e};l=!1}const c=function(e){if(e.length<=1)return e;const t=[];let r=[];return e.forEach((e=>{"["===e[0]?(t.push(...r.sort(),e),r=[]):r.push(e)})),t.push(...r.sort()),t}(t).join(":");return{isTailwindClass:!0,modifierId:o?c+R:c,classGroupId:a,originalClassName:e,hasPostfixModifier:l}})).reverse().filter((e=>{if(!e.isTailwindClass)return!0;const{modifierId:t,classGroupId:r,hasPostfixModifier:n}=e,i=t+r;return!s.has(i)&&(s.add(i),o(r,n).forEach((e=>s.add(t+e))),!0)})).reverse().map((e=>e.originalClassName)).join(" ")}(e,r);return o(e,s),s}return function(){return s(N.apply(null,arguments))}}function B(e){const t=t=>t[e]||[];return t.isThemeGetter=!0,t}const M=/^\[(?:([a-z-]+):)?(.+)\]$/i,$=/^\d+\/\d+$/,D=new Set(["px","full","screen"]),_=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,z=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,F=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,U=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,I=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/;function L(e){return G(e)||D.has(e)||$.test(e)}function J(e){return oe(e,"length",se)}function G(e){return Boolean(e)&&!Number.isNaN(Number(e))}function H(e){return oe(e,"number",G)}function q(e){return Boolean(e)&&Number.isInteger(Number(e))}function W(e){return e.endsWith("%")&&G(e.slice(0,-1))}function K(e){return M.test(e)}function Z(e){return _.test(e)}const Y=new Set(["length","size","percentage"]);function Q(e){return oe(e,Y,ie)}function X(e){return oe(e,"position",ie)}const ee=new Set(["image","url"]);function te(e){return oe(e,ee,le)}function re(e){return oe(e,"",ae)}function ne(){return!0}function oe(e,t,r){const n=M.exec(e);return!!n&&(n[1]?"string"==typeof t?n[1]===t:t.has(n[1]):r(n[2]))}function se(e){return z.test(e)&&!F.test(e)}function ie(){return!1}function ae(e){return U.test(e)}function le(e){return I.test(e)}Symbol.toStringTag;function ce(){const e=B("colors"),t=B("spacing"),r=B("blur"),n=B("brightness"),o=B("borderColor"),s=B("borderRadius"),i=B("borderSpacing"),a=B("borderWidth"),l=B("contrast"),c=B("grayscale"),d=B("hueRotate"),u=B("invert"),h=B("gap"),p=B("gradientColorStops"),f=B("gradientColorStopPositions"),g=B("inset"),m=B("margin"),v=B("opacity"),y=B("padding"),w=B("saturate"),b=B("scale"),k=B("sepia"),x=B("skew"),E=B("space"),S=B("translate"),C=()=>["auto",K,t],P=()=>[K,t],j=()=>["",L,J],R=()=>["auto",G,K],A=()=>["","0",K],V=()=>[G,H],N=()=>[G,K];return{cacheSize:500,separator:":",theme:{colors:[ne],spacing:[L,J],blur:["none","",Z,K],brightness:V(),borderColor:[e],borderRadius:["none","","full",Z,K],borderSpacing:P(),borderWidth:j(),contrast:V(),grayscale:A(),hueRotate:N(),invert:A(),gap:P(),gradientColorStops:[e],gradientColorStopPositions:[W,J],inset:C(),margin:C(),opacity:V(),padding:P(),saturate:V(),scale:V(),sepia:A(),skew:N(),space:P(),translate:P()},classGroups:{aspect:[{aspect:["auto","square","video",K]}],container:["container"],columns:[{columns:[Z]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",K]}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",q,K]}],basis:[{basis:C()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",K]}],grow:[{grow:A()}],shrink:[{shrink:A()}],order:[{order:["first","last","none",q,K]}],"grid-cols":[{"grid-cols":[ne]}],"col-start-end":[{col:["auto",{span:["full",q,K]},K]}],"col-start":[{"col-start":R()}],"col-end":[{"col-end":R()}],"grid-rows":[{"grid-rows":[ne]}],"row-start-end":[{row:["auto",{span:[q,K]},K]}],"row-start":[{"row-start":R()}],"row-end":[{"row-end":R()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",K]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",K]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal","start","end","center","between","around","evenly","stretch"]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[y]}],px:[{px:[y]}],py:[{py:[y]}],ps:[{ps:[y]}],pe:[{pe:[y]}],pt:[{pt:[y]}],pr:[{pr:[y]}],pb:[{pb:[y]}],pl:[{pl:[y]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",K,t]}],"min-w":[{"min-w":[K,t,"min","max","fit"]}],"max-w":[{"max-w":[K,t,"none","full","min","max","fit","prose",{screen:[Z]},Z]}],h:[{h:[K,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[K,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[K,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[K,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Z,J]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",H]}],"font-family":[{font:[ne]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",K]}],"line-clamp":[{"line-clamp":["none",G,H]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",L,K]}],"list-image":[{"list-image":["none",K]}],"list-style-type":[{list:["none","disc","decimal",K]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","none","wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",L,J]}],"underline-offset":[{"underline-offset":["auto",L,K]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:P()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",K]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",K]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",X]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Q]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},te]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[f]}],"gradient-via-pos":[{via:[f]}],"gradient-to-pos":[{to:[f]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:["solid","dashed","dotted","double","none","hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[o]}],"border-color-x":[{"border-x":[o]}],"border-color-y":[{"border-y":[o]}],"border-color-t":[{"border-t":[o]}],"border-color-r":[{"border-r":[o]}],"border-color-b":[{"border-b":[o]}],"border-color-l":[{"border-l":[o]}],"divide-color":[{divide:[o]}],"outline-style":[{outline:["","solid","dashed","dotted","double","none"]}],"outline-offset":[{"outline-offset":[L,K]}],"outline-w":[{outline:[L,J]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:j()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[L,J]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Z,re]}],"shadow-color":[{shadow:[ne]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Z,K]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[u]}],saturate:[{saturate:[w]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",K]}],duration:[{duration:N()}],ease:[{ease:["linear","in","out","in-out",K]}],delay:[{delay:N()}],animate:[{animate:["none","spin","ping","pulse","bounce",K]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[b]}],"scale-x":[{"scale-x":[b]}],"scale-y":[{"scale-y":[b]}],rotate:[{rotate:[q,K]}],"translate-x":[{"translate-x":[S]}],"translate-y":[{"translate-y":[S]}],"skew-x":[{"skew-x":[x]}],"skew-y":[{"skew-y":[x]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",K]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",K]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":P()}],"scroll-mx":[{"scroll-mx":P()}],"scroll-my":[{"scroll-my":P()}],"scroll-ms":[{"scroll-ms":P()}],"scroll-me":[{"scroll-me":P()}],"scroll-mt":[{"scroll-mt":P()}],"scroll-mr":[{"scroll-mr":P()}],"scroll-mb":[{"scroll-mb":P()}],"scroll-ml":[{"scroll-ml":P()}],"scroll-p":[{"scroll-p":P()}],"scroll-px":[{"scroll-px":P()}],"scroll-py":[{"scroll-py":P()}],"scroll-ps":[{"scroll-ps":P()}],"scroll-pe":[{"scroll-pe":P()}],"scroll-pt":[{"scroll-pt":P()}],"scroll-pr":[{"scroll-pr":P()}],"scroll-pb":[{"scroll-pb":P()}],"scroll-pl":[{"scroll-pl":P()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",K]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[L,J,H]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}const de=T(ce);var ue=r(36231);r(51374);function he(...e){return t=>e.forEach((e=>function(e,t){"function"==typeof e?e(t):null!=e&&(e.current=t)}(e,t)))}const pe=(0,n.forwardRef)(((e,t)=>{const{children:r,...o}=e,s=n.Children.toArray(r),i=s.find(me);if(i){const e=i.props.children,r=s.map((t=>t===i?n.Children.count(e)>1?n.Children.only(null):(0,n.isValidElement)(e)?e.props.children:null:t));return(0,n.createElement)(fe,(0,ue.A)({},o,{ref:t}),(0,n.isValidElement)(e)?(0,n.cloneElement)(e,void 0,r):null)}return(0,n.createElement)(fe,(0,ue.A)({},o,{ref:t}),r)}));pe.displayName="Slot";const fe=(0,n.forwardRef)(((e,t)=>{const{children:r,...o}=e;return(0,n.isValidElement)(r)?(0,n.cloneElement)(r,{...ve(o,r.props),ref:t?he(t,r.ref):r.ref}):n.Children.count(r)>1?n.Children.only(null):null}));fe.displayName="SlotClone";const ge=({children:e})=>(0,n.createElement)(n.Fragment,null,e);function me(e){return(0,n.isValidElement)(e)&&e.type===ge}function ve(e,t){const r={...t};for(const n in t){const o=e[n],s=t[n];/^on[A-Z]/.test(n)?o&&s?r[n]=(...e)=>{s(...e),o(...e)}:o&&(r[n]=o):"style"===n?r[n]={...o,...s}:"className"===n&&(r[n]=[o,s].filter(Boolean).join(" "))}return{...e,...r}}const ye=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce(((e,t)=>{const r=(0,n.forwardRef)(((e,r)=>{const{asChild:o,...s}=e,i=o?pe:t;return(0,n.useEffect)((()=>{window[Symbol.for("radix-ui")]=!0}),[]),(0,n.createElement)(i,(0,ue.A)({},s,{ref:r}))}));return r.displayName=`Primitive.${t}`,{...e,[t]:r}}),{});const we=(0,n.forwardRef)(((e,t)=>(0,n.createElement)(ye.label,(0,ue.A)({},e,{ref:t,onMouseDown:t=>{var r;null===(r=e.onMouseDown)||void 0===r||r.call(e,t),!t.defaultPrevented&&t.detail>1&&t.preventDefault()}})))),be=we;function ke(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=ke(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function xe(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=ke(e))&&(n&&(n+=" "),n+=t);return n}const Ee=e=>"boolean"==typeof e?"".concat(e):0===e?"0":e,Se=xe,Ce=(e,t)=>r=>{var n;if(null==(null==t?void 0:t.variants))return Se(e,null==r?void 0:r.class,null==r?void 0:r.className);const{variants:o,defaultVariants:s}=t,i=Object.keys(o).map((e=>{const t=null==r?void 0:r[e],n=null==s?void 0:s[e];if(null===t)return null;const i=Ee(t)||Ee(n);return o[e][i]})),a=r&&Object.entries(r).reduce(((e,t)=>{let[r,n]=t;return void 0===n||(e[r]=n),e}),{}),l=null==t||null===(n=t.compoundVariants)||void 0===n?void 0:n.reduce(((e,t)=>{let{class:r,className:n,...o}=t;return Object.entries(o).every((e=>{let[t,r]=e;return Array.isArray(r)?r.includes({...s,...a}[t]):{...s,...a}[t]===r}))?[...e,r,n]:e}),[]);return Se(e,i,l,null==r?void 0:r.class,null==r?void 0:r.className)};var Pe=r(69756),je=n.createContext({handler:()=>{}});function Re(e){const{handler:t}=n.useContext(je);return r=>{t({...e,...r??{}})}}Pe.u;var Ae={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Ve=((e,t)=>{const r=(0,n.forwardRef)((({color:r="currentColor",size:o=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:a="",children:l,...c},d)=>{return(0,n.createElement)("svg",{ref:d,...Ae,width:o,height:o,stroke:r,strokeWidth:i?24*Number(s)/Number(o):s,className:["lucide",`lucide-${u=e,u.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,a].join(" "),...c},[...t.map((([e,t])=>(0,n.createElement)(e,t))),...Array.isArray(l)?l:[l]]);var u}));return r.displayName=`${e}`,r})("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Ne="horizontal",Oe=["horizontal","vertical"],Te=(0,n.forwardRef)(((e,t)=>{const{decorative:r,orientation:o=Ne,...s}=e,i=Be(o)?o:Ne,a=r?{role:"none"}:{"aria-orientation":"vertical"===i?i:void 0,role:"separator"};return(0,n.createElement)(ye.div,(0,ue.A)({"data-orientation":i},a,s,{ref:t}))}));function Be(e){return Oe.includes(e)}Te.propTypes={orientation(e,t,r){const n=e[t],o=String(n);return n&&!Be(n)?new Error(function(e,t){return`Invalid prop \`orientation\` of value \`${e}\` supplied to \`${t}\`, expected one of:\n  - horizontal\n  - vertical\n\nDefaulting to \`${Ne}\`.`}(o,r)):null}};const Me=Te;function $e(...e){return de(w(e))}var De=n.forwardRef((({className:e,type:t,...r},o)=>n.createElement("input",{type:t,className:$e("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),ref:o,...r})));De.displayName="Input";var _e=Ce("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ze=n.forwardRef((({className:e,...t},r)=>n.createElement(be,{ref:r,className:$e(_e(),e),...t})));ze.displayName=be.displayName;var Fe=["Delete","Backspace","Tab","Home","End","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Escape"],Ue=(e,t)=>{const[r,o]=n.useState(e.value??""),s=n.useRef(void 0),i=(e=>{const t=Re({element:"text_input",asset:e});return r=>{let n="modified";r!==e.value&&(r&&!e.value?n="added":!r&&e.value&&(n="deleted"),t({action:n}))}})(e),{liveFormat:a,suppressBeacons:l,quickFormatDelay:c,slowFormatDelay:d,slowFormatKeys:u,decimalSymbol:h,prefix:p,suffix:f}=((e={})=>({liveFormat:!0,suppressBeacons:!1,quickFormatDelay:200,slowFormatDelay:1e3,slowFormatKeys:Fe,decimalSymbol:".",prefix:"",suffix:"",...e}))(t);function g(){s.current&&(clearTimeout(s.current),s.current=void 0)}function m(e){return e?`${p}${e}${f}`:""}const v=e.value;return n.useEffect((()=>{o(m(v))}),[v]),n.useEffect((()=>g),[]),{onBlur:t=>{g();const r=(p?t.target.value.replace(p,""):e.format(t.target.value))??"";r?(e.set(r),o(m(r))):(e.set(""),o("")),l||i(r)},onChange:e=>{o(e.target.value)},onKeyDown:t=>{g(),p&&function(e){const t=e.target,r=t.selectionStart,n=t.selectionEnd,o=p.length,s=r===o,i=n===o;r&&n&&r<o?(e.preventDefault(),t.setSelectionRange(o,n-r+o)):("ArrowLeft"===e.key&&s||"Backspace"===e.key&&s&&i||"Home"===e.key)&&(e.preventDefault(),t.setSelectionRange(p.length,p.length))}(t);const r=t.target;a&&(s.current=setTimeout((()=>{const t=r.selectionStart,n=r.value;if(t!==n.length)return;const s=(t=>{const r=t.indexOf(h),n=e.format(t)??"",o=n.indexOf(h);return(-1===r||0===r)&&o>0?{newValue:n.includes(p)?`${n}`:`${p}${n}`,newCursorPosition:n.includes(p)?o:o+p.length}:{newValue:n.includes(p)?`${n}`:`${p}${n}`}})(n);o(s.newValue),r.selectionStart=s.newCursorPosition??r.selectionStart,r.selectionEnd=s.newCursorPosition??r.selectionEnd}),function(e){const t=u.every((e=>"number"==typeof e))?e.which:e.key;return u.includes(t)?d:c}(t)))},onFocus:e=>{const t=e.target,r=""===t.value;(!r&&f||r&&p)&&o(function(e){let t=e.value;return f&&(t=t.substring(0,t.indexOf(f))),p&&!t.includes(p)&&(t=`${p}${t}`),t}(t))},value:r}},Ie=e=>{const{validation:t,label:r,id:s,note:i}=e,a=Ue(e);return n.createElement("div",{className:"grid w-full max-w-sm items-center gap-1.5"},r&&n.createElement(ze,{htmlFor:s},n.createElement(o.on,{...r})),n.createElement(De,{id:s,"aria-invalid":Boolean(t),"aria-describedby":t?`${s}-validation`:void 0,...a}),t&&n.createElement(ze,{id:`${s}-validation`,className:"text-[0.8rem] font-medium text-destructive"},t.message),i&&n.createElement(ze,{className:"text-[0.8rem] text-muted-foreground"},n.createElement(o.on,{...i})))},Le=n.createContext(void 0),Je=e=>{const t=(e=>{let t;const r=(0,n.useContext)(Le);return e.modifiers&&r?.getClassForModifier&&(t=b(...e.modifiers.map(r.getClassForModifier))),{...(0,o.C3)(e),className:t,children:e.value}})(e),r=(s=e,s.modifiers?.find((e=>"link"===e.type&&void 0!==e.metaData?.ref)));var s;const{value:i}=e;return r?n.createElement("a",{className:"underline text-blue-600 hover:text-blue-800 visited:text-purple-600",href:r.metaData.ref},i):n.createElement("span",{...t},i)},Ge=e=>n.createElement("div",{className:"flex flex-col gap-4"},e.label&&n.createElement("h3",null,n.createElement(o.on,{...e.label})),e.values?.map((e=>n.createElement(o.on,{key:e.asset.id,...e})))),He=Ce("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),qe=n.forwardRef((({className:e,variant:t,size:r,asChild:o=!1,...s},i)=>{const a=o?pe:"button";return n.createElement(a,{className:$e(He({variant:t,size:r,className:e})),ref:i,...s})}));qe.displayName="Button";var We=e=>{const{label:t}=e,r=(e=>{const{label:t}=e,r=Re({asset:e,action:"clicked",element:"button"});return{id:e.id,onClick:()=>{r(),e.run()},children:t?.asset?n.createElement(o.on,{...t?.asset}):null}})(e);return n.createElement("div",null,n.createElement(qe,{variant:h(e)?"outline":void 0,...r},"back"===e?.metaData?.role&&n.createElement(Ve,null),t&&n.createElement(o.on,{...t})))},Ke=n.forwardRef((({className:e,orientation:t="horizontal",decorative:r=!0,...o},s)=>n.createElement(Me,{ref:s,decorative:r,orientation:t,className:$e("shrink-0 bg-border","horizontal"===t?"h-[1px] w-full":"h-full w-[1px]",e),...o})));Ke.displayName=Me.displayName;var Ze=e=>n.createElement("div",{className:"max-w-full"},n.createElement("div",{className:"flex flex-col gap-4"},e.title&&n.createElement("h1",{className:"scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl"},n.createElement(o.on,{...e.title})),e.subTitle&&n.createElement("h3",{className:"scroll-m-20 text-2xl font-semibold tracking-tight"},n.createElement(o.on,{...e.subTitle})),e.primaryInfo&&n.createElement("div",null,n.createElement(o.on,{...e.primaryInfo})),n.createElement("div",{className:"flex flex-col gap-4"},e?.segmentedActions&&n.createElement(Ke,null),n.createElement("div",{className:"flex justify-between sm:flex-row flex-col-reverse gap-4"},n.createElement("div",{className:"flex gap-4"},e?.segmentedActions?.prev?.map((e=>n.createElement(o.on,{key:e.asset.id,...e})))),n.createElement("div",{className:"flex gap-4"},e?.segmentedActions?.next?.map((e=>n.createElement(o.on,{key:e.asset.id,...e})))))))),Ye=e=>{const{metaData:t,caption:r,altText:s}=e;return n.createElement("figure",{className:"figure"},n.createElement("img",{className:"figure-img img-fluid",src:t.ref,alt:s}),r&&n.createElement("figcaption",{className:"figure-caption",style:{marginTop:15}},n.createElement(o.on,{...r})))},Qe=e=>{const{label:t,id:r,...s}=e;return n.createElement("div",{className:"flex items-center gap-1.5"},n.createElement(De,{type:"radio",className:"h-fit w-fit shadow-none",id:r,...s}),t&&n.createElement(ze,{htmlFor:r},n.createElement(o.on,{...t})))},Xe=e=>{const{validation:t,title:r,id:s,note:i}=e,a=(e=>{const t=Re({asset:e,action:"clicked",element:"choice"});return e.items?.map((r=>{const{id:n,value:o,label:s}=r;return{id:n,label:s,name:e.id,value:(o??"").toString(),checked:o===e.value,onChange:()=>{t(),r.select()}}}))??[]})(e);return n.createElement("div",{className:"grid w-full max-w-sm items-center gap-3"},r&&n.createElement(ze,{htmlFor:s},n.createElement(o.on,{...r})),n.createElement("div",{id:e.id,className:"grid gap-2","aria-invalid":Boolean(t),"aria-describedby":t?`${s}-validation`:void 0},a.map((e=>n.createElement(Qe,{key:e.id,...e})))),t&&n.createElement(ze,{id:`${s}-validation`,className:"text-[0.8rem] font-medium text-destructive"},t.message),i&&n.createElement(ze,{className:"text-[0.8rem] text-muted-foreground"},n.createElement(o.on,{...i})))},et=class{constructor(){this.name="reference-assets-web-plugin"}applyReact(e){e.registerPlugin(new s([["input",Ie],["text",Je],["action",We],["info",Ze],["collection",Ge],["image",Ye],["choice",Xe]]))}apply(e){e.registerPlugin(new v)}}},54322:(e,t,r)=>{"use strict";function n(e,t,r){return e.context?e.callback(r,...t):e.callback(...t)}r.d(t,{BD:()=>d,Jk:()=>i,PI:()=>c,hj:()=>l,jJ:()=>a});class o{constructor(){this.interceptions=[],this.interceptionKeySet=new Set}isUsed(){return this.interceptions.length>0}intercept(e){this.interceptions.push(e),Object.keys(e).forEach((e=>{this.interceptionKeySet.add(e)}))}tap(e){this.interceptionKeySet.has("tap")&&this.interceptions.forEach((t=>{var r;null==(r=t.tap)||r.call(t,e)}))}call(e,...t){this.interceptionKeySet.has("call")&&this.interceptions.forEach((r=>{var n,o;r.context?null==(n=r.call)||n.call(r,e,...t):null==(o=r.call)||o.call(r,...t)}))}loop(...e){this.interceptionKeySet.has("loop")&&this.interceptions.forEach((t=>{var r;null==(r=t.loop)||r.call(t,...e)}))}error(e){if(this.interceptionKeySet.has("error")&&e instanceof Error){const t=e;this.interceptions.forEach((e=>{var r;null==(r=e.error)||r.call(e,t)}))}}result(e){this.interceptionKeySet.has("result")&&this.interceptions.forEach((t=>{var r;null==(r=t.result)||r.call(t,e)}))}done(){this.interceptionKeySet.has("done")&&this.interceptions.forEach((e=>{var t;null==(t=e.done)||t.call(e)}))}}class s{constructor(){this.taps=[],this.interceptions=new o}tap(e,t){const r="string"==typeof e?{name:e,context:!1}:{context:!1,...e},n={key:Symbol(r.name),...r,callback:t};if(n.before){let e=this.taps.length;const t=new Set(Array.isArray(n.before)?n.before:[n.before]);for(;e>0&&t.size>0;e--){const r=this.taps[e-1];if(t.has(r.name)&&t.delete(r.name),r.before&&(o=n.name,s=r.before,Array.isArray(s)?s.includes(o):s===o))break}this.taps.splice(e,0,n)}else this.taps.push(n);var o,s;return this.interceptions.tap(n),n}untap(e){this.taps=this.taps.filter((t=>t.key!==e.key))}isUsed(){return this.taps.length>0||this.interceptions.isUsed()}intercept(e){this.interceptions.intercept(e)}}class i extends s{call(...e){if(!this.isUsed())return;const t={};this.interceptions.call(t,...e);try{this.taps.forEach((r=>{n(r,e,t)}))}catch(e){throw this.interceptions.error(e),e}this.interceptions.done()}}class a extends s{call(...e){if(!this.isUsed())return;const t={};this.interceptions.call(t,...e);for(let r=0;r<this.taps.length;r+=1){const o=n(this.taps[r],e,t);if(void 0!==o)return this.interceptions.result(o),o}this.interceptions.done()}}class l extends s{call(...e){const t={};this.interceptions.call(t,...e);let[r,...o]=e;for(let e=0;e<this.taps.length;e+=1){const s=n(this.taps[e],[r,...o],t);void 0!==s&&(r=s)}return this.interceptions.result(r),r}}class c extends s{async call(...e){const t={};this.interceptions.call(t,...e),await Promise.allSettled(this.taps.map((r=>n(r,e,t)))),this.interceptions.done()}}class d extends s{async call(...e){let[t,...r]=e;const o={};this.interceptions.call(o,...e);try{for(let e=0;e<this.taps.length;e+=1){const s=await n(this.taps[e],[t,...r],o);void 0!==s&&(t=s)}}catch(e){throw this.interceptions.error(e),e}return this.interceptions.result(t),t}}}}]);
//# sourceMappingURL=4971.71da147a26981b580f3e.js.map