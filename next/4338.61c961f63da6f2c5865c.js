"use strict";(self.webpackChunk_player_ui_docs=self.webpackChunk_player_ui_docs||[]).push([[4338],{83190:(e,n,t)=>{t.d(n,{xA:()=>p,yg:()=>m});var a=t(52112);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},l=Object.keys(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)t=l[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),u=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},p=function(e){var n=u(e.components);return a.createElement(s.Provider,{value:n},e.children)},c="mdxType",g={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},y=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,l=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),c=u(t),y=r,m=c["".concat(s,".").concat(y)]||c[y]||g[y]||l;return t?a.createElement(m,o(o({ref:n},p),{},{components:t})):a.createElement(m,o({ref:n},p))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var l=t.length,o=new Array(l);o[0]=y;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[c]="string"==typeof e?e:r,o[1]=i;for(var u=2;u<l;u++)o[u]=t[u];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}y.displayName="MDXCreateElement"},54338:(e,n,t)=>{t.r(n),t.d(n,{default:()=>p});t(52112);var a=t(83190),r=t(21525);function l(){return l=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},l.apply(this,arguments)}const o=(i="PlatformTabs",function(e){return console.warn("Component "+i+" was not imported, exported, or provided by MDXProvider as global scope"),(0,a.yg)("div",e)});var i;const s={},u=(0,r.A)({title:"PubSub",platform:"core,react,ios,android",tableOfContents:[{text:"PubSub Plugin",id:"pubsub-plugin",level:1},{text:"Usage",id:"usage",level:2},{text:"CocoaPods",id:"cocoapods",level:3},{text:"Swift Usage",id:"swift-usage",level:3},{text:"Publish Expression",id:"publish-expression",level:2}]});function p(e){let{components:n,...t}=e;return(0,a.yg)(u,l({},s,t,{components:n,mdxType:"MDXLayout"}),(0,a.yg)("h1",{id:"pubsub-plugin"},(0,a.yg)("a",{parentName:"h1",href:"#pubsub-plugin"},"PubSub Plugin")),(0,a.yg)("p",null,"The PubSub plugin adds a publish/subscribe interface between the host app and Player’s content. "),(0,a.yg)("h2",{id:"usage"},(0,a.yg)("a",{parentName:"h2",href:"#usage"},"Usage")),(0,a.yg)(o,{mdxType:"PlatformTabs"},(0,a.yg)("core",null,(0,a.yg)("p",null,"Add the plugin to Player:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-ts"},"import { Player } from '@player-ui/player';\nimport { PubSubPlugin } from '@player-ui/pub-sub-plugin';\n\nconst pubsub = new PubSubPlugin();\n\nconst token = pubsub.subscribe('some-event', () => {\n  // Callback\n});\n\nconst player = new Player({\n  plugins: [pubsub]\n})\n")),(0,a.yg)("p",null,"To unsubscribe:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-ts"},"pubsub.unsubscribe(token);\n"))),(0,a.yg)("ios",null,(0,a.yg)("p",null,"If your content uses the ",(0,a.yg)("inlineCode",{parentName:"p"},"@[ publish() ]@")," expression for actions, you can subscribe to these events by using the ",(0,a.yg)("inlineCode",{parentName:"p"},"PubSubPlugin"),"."),(0,a.yg)("h3",{id:"cocoapods"},(0,a.yg)("a",{parentName:"h3",href:"#cocoapods"},"CocoaPods")),(0,a.yg)("p",null,"Add the subspec to your ",(0,a.yg)("inlineCode",{parentName:"p"},"Podfile")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-ruby"},"pod 'PlayerUI/PubSubPlugin'\n")),(0,a.yg)("h3",{id:"swift-usage"},(0,a.yg)("a",{parentName:"h3",href:"#swift-usage"},"Swift Usage")),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-swift"},'let eventHandler: (String, AnyType?) -> Void = { (eventName, eventData) in\n  // Handle event\n}\nlet plugin = PubSubPlugin([("eventName", eventHandler)])\n')),(0,a.yg)("p",null,"If your content uses a different name for publishing (such as ",(0,a.yg)("inlineCode",{parentName:"p"},"publishEvent"),") you can customize the expression name that the plugin uses:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-swift"},'let plugin = PubSubPlugin([("eventName", eventHandler)], options: PubSubPluginOptions(expressionName: "publishEvent"))\n')),(0,a.yg)("p",null,"Then, just include it in your ",(0,a.yg)("inlineCode",{parentName:"p"},"plugins")," to a Player instance:"),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-swift"},"var body: some View {\n  SwiftUIPlayer(\n    flow: flow,\n    plugins: [\n      plugin\n    ],\n    result: $resultBinding\n  )\n}\n")),(0,a.yg)("p",null,(0,a.yg)("em",{parentName:"p"},"Note: AnyType is a custom enum type to handle the arbitrary types that can be received from these events, as the data is set in your Player Content, ensure that it matches either String, ","[String]",", or ","[String: String]","."))),(0,a.yg)("android",null,(0,a.yg)("p",null,"The ",(0,a.yg)("inlineCode",{parentName:"p"},"PubSubPlugin")," provides support for handling the publish expressions in Player content at the app level. The PubSubPlugin is included by default in the Android Player, so configuring events subscriptions can be done on Player using the provided extension methods."),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "id": "action",\n  "type": "action",\n  "exp": "@[ publish(\'some-event\', {{foo.bar}}) ]@"\n}\n')),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-kotlin"},'val player = AndroidPlayer(context)\n\n// extension method for subscribing to some event\nval token = player.subscribe("some-event") { name: String, data: Any? ->\n    // name of event can be used for logging\n    // data can be any structure passed by the content, if any\n    // handle event\n}\n\n// extension method for removing a specific event subscription \nplayer.unsubscribe(token)\n')))),(0,a.yg)("h2",{id:"publish-expression"},(0,a.yg)("a",{parentName:"h2",href:"#publish-expression"},"Publish Expression")),(0,a.yg)("p",null,"To trigger an event to be published, use the ",(0,a.yg)("inlineCode",{parentName:"p"},"publish()")," expression in Player’s content: "),(0,a.yg)("pre",null,(0,a.yg)("code",{parentName:"pre",className:"language-json"},'{\n  "asset": {\n    "id": "sample",\n    "type": "action",\n    "exp": "@[ publish(\'some-event\', \'some optional data\') ]@""\n  }\n}\n')),(0,a.yg)("hr",null),(0,a.yg)("p",null,(0,a.yg)("a",{parentName:"p",href:"https://github.dev/player-ui/player/blob/main/docs/site/pages/plugins/pub-sub.mdx"},"Help to improve this page")))}p.isMDXComponent=!0},21525:(e,n,t)=>{t.d(n,{A:()=>E});var a=t(52112),r=t(9495),l=t(32532),o=t(83190),i=t(37766),s=t(90283),u=t(14769),p=t(63420),c=t(23013),g=t(47482),y=t(52947),m=t(53868),b=t(13516),d="chakra-skip-nav";function f(e){return{userSelect:"none",border:"0",height:"1px",width:"1px",margin:"-1px",padding:"0",outline:"0",overflow:"hidden",position:"absolute",clip:"rect(0 0 0 0)",...e,_focus:{clip:"auto",width:"auto",height:"auto",...e._focus}}}var h=(0,c.R)((function(e,n){const t=(0,g.Vl)("SkipLink",e),{id:a=d,...r}=(0,y.MN)(e);return(0,b.jsx)(m.B.a,{...r,ref:n,href:`#${a}`,__css:f(t)})}));h.displayName="SkipNavLink";var v=(0,c.R)((function(e,n){const{id:t=d,...a}=e;return(0,b.jsx)(m.B.div,{ref:n,id:t,tabIndex:-1,style:{outline:0},...a})}));v.displayName="SkipNavContent";var x=t(43298),P=t(2063);const N=e=>a.createElement(s.az,{display:{base:"none",xl:"block"}},"Table Of Contents",a.createElement(u._J,{spacing:1,ml:"0",mt:"4",styleType:"none"},e.tableOfContents?.map((e=>a.createElement("li",{key:e.text},a.createElement("a",{href:`#${e.id}`},e.text)))))),w=e=>{const{bannerExpanded:n}=a.useContext(x.BR),t="72px",l=`calc(100vh - 88px - ${n?t:"0px"})`,o=`calc(100vh - 88px - 105px - ${n?t:"0px"})`;return a.createElement(s.az,{minH:"100vh"},a.createElement(h,null,"Skip to Main Content"),a.createElement(r.s,{flexDir:"column",padding:"2"},a.createElement(P.IS,null),a.createElement(p.c,null),a.createElement(r.s,null,a.createElement(s.az,{as:"main",w:"100%",mx:"auto"},a.createElement(s.az,{display:{md:"flex"}},a.createElement(s.az,{display:{base:"none",md:"block"},overflow:"auto",maxH:l,pr:"8",ml:"4"},a.createElement(P.E1,null)),a.createElement(s.az,{flex:"1",minW:"0",overflow:"auto",maxH:l},a.createElement(s.az,{minH:o},a.createElement(v,null),e.children),a.createElement(s.az,{pt:"20"},a.createElement(P.wi,null))),e.tableOfContents&&a.createElement(N,{tableOfContents:e.tableOfContents}))))))};function E(e){return e=>a.createElement(w,null,a.createElement(r.s,{alignItems:"center"},a.createElement(l.m,{maxW:"container.lg"},a.createElement(o.xA,{components:i.Ul},e.children))))}}}]);
//# sourceMappingURL=4338.61c961f63da6f2c5865c.js.map